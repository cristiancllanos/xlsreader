<!DOCTYPE html>
<!-- saved from url=(0061)https://developers.google.com/google-apps/spreadsheets/?hl=es -->
<html lang="en" class="wf-opensans-n4-active wf-active"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Google Apps Platform — Google Developers_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" async="" src="./Google Apps Platform — Google Developers_files/plusone.js" gapi_processed="true"></script>
    <meta charset="utf-8">
    <script src="./Google Apps Platform — Google Developers_files/script_head.js"></script>
    <link rel="stylesheet" type="text/css" href="./Google Apps Platform — Google Developers_files/screen.css">
    <link rel="shortcut icon" href="https://developers.google.com/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://developers.google.com/images/apple-touch-icon.png">
    <link href="./Google Apps Platform — Google Developers_files/css" rel="stylesheet" type="text/css">
    <script src="./Google Apps Platform — Google Developers_files/jquery.min.js"></script>
    <script id="jqueryui" src="./Google Apps Platform — Google Developers_files/jquery-ui.min.js"></script>
    <script src="./Google Apps Platform — Google Developers_files/jsapi"></script>
    <script>
      google.load('visualization', '1', {packages: ['table']});
    </script><script src="./Google Apps Platform — Google Developers_files/saved_resource" type="text/javascript"></script><script src="./Google Apps Platform — Google Developers_files/format+es,default,table.I.js" type="text/javascript"></script><style>.a-b-c{position:relative;display:-moz-inline-box;display:inline-block}* html .a-b-c,*:first-child+html .a-b-c{display:inline}.a-d-e{margin:2px;border:0;padding:0;font-family:Arial,sans-serif;color:#000;background:#ddd url(//ssl.gstatic.com/editor/button-bg.png) repeat-x top left;text-decoration:none;list-style:none;vertical-align:middle;cursor:default;outline:none}.a-d-e-f-g,.a-d-e-h-g{border-style:solid;border-color:#aaa;vertical-align:top}.a-d-e-f-g{margin:0;border-width:1px 0;padding:0}.a-d-e-h-g{-moz-box-orient:vertical;margin:0 -1px;border-width:0 1px;padding:3px 4px;white-space:nowrap}* html .a-d-e-h-g{left:-1px}* html .a-d-e-i .a-d-e-f-g{left:-1px}* html .a-d-e-i .a-d-e-h-g{right:auto}*:first-child+html .a-d-e-h-g{left:-1px}*:first-child+html .a-d-e-i .a-d-e-h-g{left:1px}::root .a-d-e,::root .a-d-e-f-g{line-height:0}::root .a-d-e-h-g{line-height:normal}.a-d-e-j{background-image:none!important;opacity:.3;-moz-opacity:.3;filter:alpha(opacity=30)}.a-d-e-j .a-d-e-f-g,.a-d-e-j .a-d-e-h-g{color:#333!important;border-color:#999!important}* html .a-d-e-j,*:first-child+html .a-d-e-j{margin:2px 1px!important;padding:0 1px!important}.a-d-e-k .a-d-e-f-g,.a-d-e-k .a-d-e-h-g{border-color:#9cf #69e #69e #7af!important}.a-d-e-l,.a-d-e-m{background-color:#bbb;background-position:bottom left}.a-d-e-n .a-d-e-f-g,.a-d-e-n .a-d-e-h-g{border-color:orange}.a-d-e-o-p,.a-d-e-o-p .a-d-e-f-g,.a-d-e-o-p .a-d-e-h-g{margin-right:0}.a-d-e-o-q,.a-d-e-o-q .a-d-e-f-g{margin-left:0}.a-d-e-o-q .a-d-e-h-g{margin-left:0;border-left:1px solid #fff}.a-d-e-o-q.a-d-e-m .a-d-e-h-g{border-left:1px solid #ddd}* html .a-d-e-o-q .a-d-e-h-g,*:first-child+html .a-d-e-o-q .a-d-e-h-g{left:0}.a-r-e{position:relative;margin:2px;border:1px solid #000;padding:2px 6px;font:normal 13px "Trebuchet MS",Tahoma,Arial,sans-serif;color:#fff;background-color:#8c2425;cursor:pointer;outline:none}.a-r-e-j{border-color:#888;color:#888;background-color:#ccc;cursor:default}.a-r-e-k{border-color:#8c2425;color:#8c2425;background-color:#eaa4a5}.a-r-e-l,.a-r-e-s,.a-r-e-m{border-color:#5b4169;color:#5b4169;background-color:#d1a8ea}.a-r-e-n{border-color:#5b4169}.a-r-e-o-p{margin-right:0}.a-r-e-o-q{margin-left:0;border-left:none}.a-e{color:#036;border-color:#036;background-color:#69c}.a-e-j{border-color:#333;color:#333;background-color:#999}.a-e-k{color:#369;border-color:#369;background-color:#9cf}.a-e-l{color:#69c;border-color:#69c}</style><link href="./Google Apps Platform — Google Developers_files/table.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="./Google Apps Platform — Google Developers_files/api.js"></script>
    <!--[if lt IE 9]>
    <script src="/js/html5shim/html5.js"></script>
    <![endif]-->

    
    <script>
      google.load('search', '1', {language : 'en'});
    </script><script src="./Google Apps Platform — Google Developers_files/saved_resource(1)" type="text/javascript"></script><link href="./Google Apps Platform — Google Developers_files/default+en.css" type="text/css" rel="stylesheet"><script src="./Google Apps Platform — Google Developers_files/default+en.I.js" type="text/javascript"></script>
    

    
  <script type="text/javascript">
    var contentTimer = new window.jstiming.Timer();

    var ___gcfg = ___gcfg || {};
    ___gcfg.lang = 'es';
  </script>
  <script src="./Google Apps Platform — Google Developers_files/jquery-ui.min.js"></script>
  
  <title>Google Apps Platform — Google Developers</title><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
  
  
  
  
  
  



    
    

  </head>
  <body class="two-column docs">
    <div id="sandbar">




<header id="gc-googlebar">

  <a id="gc-logo" href="https://developers.google.com/">
    <img src="./Google Apps Platform — Google Developers_files/developers-logo.png" alt="Google">
  </a>

  <div class="gc-social">
    
    <span class="signed-out">
      <a href="https://developers.google.com/setup?state=%2Fgoogle-apps%2Fspreadsheets%2F" id="loginLink" class="button">Sign in</a>
    </span>
    
  </div>

  <form class="gc-search" action="https://developers.google.com/search" method="GET">
    <div class="searchbox">
      
      <input type="text" name="q" class="q" id="q" value="" placeholder="Search" autocomplete="off">
    </div>
    <button class="button button-blue">
      <img src="./Google Apps Platform — Google Developers_files/search.png" alt="Search">
    </button>
  </form>

</header>



</div>
    
    
    <div class="kd-butterbar shown">
      <span>Esta página se ha trasladado al sitio de desarrolladores de Google. ¡Te damos la bienvenida! <a href="https://developers.google.com/readme?hl=es">Más información</a> <a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#" class="kd-butterbar-dismiss">Ignorar</a></span>
    </div>
    

    <div id="gc-wrapper">
      
      <input id="gc-analytics" type="hidden" value="UA-24532603-1">
      

      
      <div id="gc-topnav">
        <div>
          <ul>
            
            <li class=""><a href="https://developers.google.com/?hl=es">Inicio</a></li>
            
            <li class="active"><a href="https://developers.google.com/products/?hl=es">Products</a></li>
            
            <li class=""><a href="https://developers.google.com/events/?hl=es">Eventos</a></li>
            
            <li class=""><a href="https://developers.google.com/showcase/?hl=es">Escaparate</a></li>
            
            <li class=""><a href="https://developers.google.com/live/?hl=es">Live</a></li>
            
            <li class=""><a href="https://developers.google.com/groups/?hl=es">Grupos</a></li>
            
          </ul>
        </div>
      </div>
      
      

      
      <div id="gc-appbar">
        
        <h1>
          

  <a href="https://developers.google.com/google-apps/?hl=es">Google Apps Platform</a>
  <div class="plusone-container">
    <div id="___plusone_0" style="height: 20px; width: 90px; display: inline-block; text-indent: 0px; margin: 0px; padding: 0px; background-color: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; background-position: initial initial; background-repeat: initial initial; "><iframe allowtransparency="true" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="margin: 0px; border-style: none; height: 20px; width: 90px; position: static; left: 0px; top: 0px; visibility: visible; " tabindex="0" vspace="0" width="100%" id="I0_1343863012568" name="I0_1343863012568" src="./Google Apps Platform — Google Developers_files/fastbutton.html" title="+1"></iframe></div>
  </div>







        </h1>
        
      </div>
      

      
      <div id="gc-main">
        
      <div id="gc-sidebar">
        

  



  <nav class="gc-toc"><ul><li class="active"><a href="./Google Apps Platform — Google Developers_files/Google Apps Platform — Google Developers.html" data-title="Developer&#39;s Guide"><span>Developer's Guide</span></a></li></ul><hr><ul><li class=""><a href="http://groups.google.com/forum/embed/?place=forum/google-spreadsheets-api" data-title="Discussions"><span>Discussions</span></a></li><li class=""><a href="http://code.google.com/a/google.com/p/apps-api-issues/issues/list?q=label:API-Spreadsheets" data-title="Issue Tracker"><span>Issue Tracker</span></a></li><li class=""><a href="http://googleappsdeveloper.blogspot.com/" data-title="Blog"><span>Blog</span></a></li></ul><hr><ul><li class=""><a href="https://developers.google.com/google-apps/spreadsheets/terms?hl=es" data-title="Terms of Service"><span>Terms of Service</span></a></li></ul></nav>



      </div>

      <div id="gc-content">
        
        <div>
          
  
  



















<link rel="stylesheet" href="https://developers.google.com/google-apps/css/apps.css">


<h1 class="page-title" id="google_spreadsheets_api_version_30">Google Spreadsheets API version 3.0</h1>
<p class="warning"><b>Important:</b> Versions 1 and 2 of the Google Spreadsheets API have been
<a href="http://googledevelopers.blogspot.com/2012/04/changes-to-deprecation-policies-and-api.html">officially deprecated</a> as of April 20, 2012 and will be shut down on October 20, 2012.  Migration to v3 should be simple, as it includes all the features of v1 and v2, thus you only need to stop specifying v1 or v2 with your requests. We recommend that you update your apps to send requests to v3 as soon as possible.</p>

<p>The Google Spreadsheets API enables developers to create applications that read
and modify the data in Google Spreadsheets.</p>
<hr>
<nav class="inline-toc"><ol class="toc"><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#introduction">Introduction</a><ol class="toc"><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#what_can_this_api_do">What can this API do?</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#audience">Audience</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#terminology_used_in_this_guide">Terminology used in this guide</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#which_version_of_the_api_should_be_used">Which version of the API should be used?</a></li></ol></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#additional_resources_and_information_about_this_guide">Additional resources and information about this guide</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#setting_up_your_client_library">Setting up your client library</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#authorizing_requests">Authorizing requests</a><ol class="toc"><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#about_authorization_protocols">About authorization protocols</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#authorizing_requests_with_oauth_20">Authorizing requests with OAuth 2.0</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#authorizing_requests_with_oauth_10a">Authorizing requests with OAuth 1.0a</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#authorizing_requests_with_clientlogin">Authorizing requests with ClientLogin</a></li></ol></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#specifying_a_version">Specifying a version</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#creating_a_spreadsheet">Creating a spreadsheet</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#spreadsheets_api_urls_visibilities_and_projections">Spreadsheets API URLs, visibilities, and projections</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#retrieving_a_list_of_spreadsheets">Retrieving a list of spreadsheets</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#working_with_worksheets">Working with worksheets</a><ol class="toc"><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#retrieving_information_about_worksheets">Retrieving information about worksheets</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#adding_a_worksheet">Adding a worksheet</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#modifying_a_worksheets_title_and_size">Modifying a worksheet's title and size</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#deleting_a_worksheet">Deleting a worksheet</a></li></ol></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#working_with_list-based_feeds">Working with list-based feeds</a><ol class="toc"><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#retrieving_a_list-based_feed">Retrieving a list-based feed</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#sorting_rows">Sorting rows</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#sending_a_structured_query_for_rows">Sending a structured query for rows</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#adding_a_list_row">Adding a list row</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#updating_a_list_row">Updating a list row</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#deleting_a_list_row">Deleting a list row</a></li></ol></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#working_with_cell-based_feeds">Working with cell-based feeds</a><ol class="toc"><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#retrieving_a_cell-based_feed">Retrieving a cell-based feed</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#fetching_specific_rows_or_columns">Fetching specific rows or columns</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#changing_contents_of_a_cell">Changing contents of a cell</a></li><li><a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#updating_multiple_cells_with_a_batch_request">Updating multiple cells with a batch request</a></li></ol></li></ol></nav><hr>
<h2 id="introduction">Introduction</h2>
<p>This guide discusses how to use the Google Spreadsheets API version 3.0.</p>
<h3 id="what_can_this_api_do">What can this API do?</h3>
<p>This API is useful for:</p>
<ul>
<li>managing the worksheets in a Google spreadsheet</li>
<li>consuming the rows of a worksheet</li>
<li>managing cells in a worksheet by position</li>
</ul>
<p>Common use cases of this API include:</p>
<ul>
<li>computing financial data stored in an inaccessible system</li>
<li>presenting statistics to users in a web browser</li>
<li>consuming data entered into a spreadsheet by a user</li>
</ul>
<h3 id="audience">Audience</h3>
<p>This guide is intended for software developers needing a technical reference
for using the Google Spreadsheets API.  The information you find in this guide
is written by Google engineers, and is an authoritative reference of the API.</p>
<h3 id="terminology_used_in_this_guide">Terminology used in this guide</h3>
<p>Throughout this guide, a number of terms are used which are intended to have
specific meanings.</p>
<dl>
<dt>spreadsheet</dt>
<dd>Google Spreadsheet document, created with the Google Docs user interface or with the Google Documents List API.</dd>
<dt>worksheet</dt>
<dd>Named collection of cells within a spreadsheet.  All spreadsheets must have at least one worksheet, and have one worksheet by default.</dd>
<dt>list row</dt>
<dd>Row of cells in a worksheet, represented as a key-value pair, where each key is a column name, and each value is the cell value.  The first row of a worksheet is always considered the header row when using the API, and therefore is the row that defines the keys represented in each row.</dd>
<dt>cell</dt>
<dd>Single piece of data in a worksheet.</dd>
</dl>
<h3 id="which_version_of_the_api_should_be_used">Which version of the API should be used?</h3>
<p>Version 3.0 (the version described in this guide), is the recommended version
of the API.  There are no advantages to using previous versions of the API.
For this reason, we no longer document versions 1 or 2 of the Google
Spreadsheets API, as version 3.0 is a superset of versions 1 and 2.  Versions 1
and 2 are deprecated as of April 20, 2012, and any developer actively using
these versions is urged to upgrade.</p>
<h2 id="additional_resources_and_information_about_this_guide">Additional resources and information about this guide</h2>
<p>Occasionally, we make a mistake in this documentation, or unknowingly break a
feature that you depend on.</p>
<p>If this has happened to you, sorry! You can help us fix the issue by posting in
the <a href="https://developers.google.com/google-apps/spreadsheets/forum.html?hl=es">forum</a> or <a href="http://code.google.com/a/google.com/p/apps-api-issues/issues/list?q=label:API-Spreadsheets">by filing a
bug</a>.
We appreciate your help!</p>
<h2 id="setting_up_your_client_library">Setting up your client library</h2>
<p>A number of client libraries are provided in various languages.  These client
libraries make it easier to interact with the Spreadsheets API.</p>
<p>This section is not relevant to applications using the Spreadsheets API at the
protocol level, but all application developers should strongly consider using a
GData client library to interact with the API.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The Java client library is maintained in an open-source project on Google
    Project hosting.  The Java library itself is distributed as a ZIP file,
    containing a number of JARs that applications can import in order to gain
    access to the library.</p><p>The Java client library requires JDK 5.0 or greater.  The latest version of
the Oracle JDK is available from
<a href="http://www.oracle.com/technetwork/java/index.html">http://www.oracle.com/technetwork/java/index.html</a>.</p><p class="alert-message info note"><strong>Note:</strong><span> If using <a href="http://www.eclipse.org/">Eclipse</a>, use Eclipse's classpath
manager to import the JARs mentioned below.  Importing JARs into an Eclipse
project is described in detail
<a href="http://stackoverflow.com/questions/3280353/how-to-import-a-jar-in-eclipse">here</a>.</span></p><p class="alert-message info note"><strong>Note:</strong><span> If using <a href="http://www.netbeans.org/">NetBeans</a>, use NetBeans' project
properties manager to import the JARs mentioned below.  Importing JARs into
a NetBeans project is described in detail
<a href="http://netbeans.org/kb/docs/java/project-setup.html#projects-classpath">here</a>.</span></p><p>Unfortunately, due to restrictive licensing, we cannot at this time just
give developers a ZIP of all JARs required to interact with the API.  Some
of the JARs are not available without additional license agreements.
Because of this, some of the JARs must be downloaded individually.  We
sincerely apologize for this inconvenience.</p><p>To setup a development environment for working with the Spreadsheets API,
perform the following steps.</p><ol><li><p>Download the latest <code>gdata-src.java-*.zip</code> file from the project's
   <a href="http://code.google.com/p/gdata-java-client/downloads/list">Downloads</a>
   page.  Replace <code>*</code> in this case with something like <code>1.46.0</code>.</p></li><li><p>Extract the ZIP file into a new directory.</p><pre class="prettyprint"><code><span class="pln">unzip gdata</span><span class="pun">-</span><span class="pln">src</span><span class="pun">.</span><span class="pln">java</span><span class="pun">-</span><span class="lit">1.46</span><span class="pun">.</span><span class="lit">0.zip</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d </span><span class="pun">./</span><span class="pln">gdata</span><span class="pun">-</span><span class="pln">java</span><span class="pun">-</span><span class="pln">client<br></span></code></pre></li><li><p>Copy the JARs from <code>gdata-java-client/gdata/java/lib</code> into a directory
   included in the application's classpath.</p><pre class="prettyprint"><code><span class="pln">cp gdata</span><span class="pun">-</span><span class="pln">java</span><span class="pun">-</span><span class="pln">client</span><span class="pun">/</span><span class="pln">gdata</span><span class="pun">/</span><span class="pln">java</span><span class="pun">/</span><span class="pln">lib</span><span class="com">/* /path/to/application/lib<br></span></code></pre></li><li><p>Copy the JARs from <code>gdata-java-client/gdata/java/deps</code> into the
   application's classpath.</p><pre class="prettyprint"><code><span class="pln">cp gdata</span><span class="pun">-</span><span class="pln">java</span><span class="pun">-</span><span class="pln">client</span><span class="pun">/</span><span class="pln">gdata</span><span class="pun">/</span><span class="pln">java</span><span class="pun">/</span><span class="pln">deps</span><span class="com">/* /path/to/application/lib<br></span></code></pre></li><li><p>Download the JavaMail API (version 1.4 or greater) from
   <a href="http://www.oracle.com/technetwork/java/index-138643.html">here</a>.
   Extract the ZIP file and copy <code>mail.jar</code> to the application's classpath.</p><pre class="prettyprint"><code><span class="pln">unzip javamail1_4_4</span><span class="pun">.</span><span class="pln">zip </span><span class="pun">-</span><span class="pln">d javamail<br>cp javamail</span><span class="pun">/</span><span class="pln">javamail</span><span class="pun">-</span><span class="lit">1.4</span><span class="pun">.</span><span class="lit">4</span><span class="pun">/</span><span class="pln">mail</span><span class="pun">.</span><span class="pln">jar </span><span class="pun">/</span><span class="pln">path</span><span class="pun">/</span><span class="pln">to</span><span class="pun">/</span><span class="pln">application</span><span class="pun">/</span><span class="pln">lib<br></span></code></pre></li><li><p>If using the Oracle JDK version 1.5, download the JavaBeans Activation
   Framework from
   <a href="http://www.oracle.com/technetwork/java/javase/downloads/index-135046.html">here</a>.
   Extract the ZIP file and copy <code>activation.jar</code> to the application's
   classpath.</p><pre class="prettyprint"><code><span class="pln">unzip jaf</span><span class="pun">-</span><span class="lit">1_1_1.zip</span><span class="pln"> </span><span class="pun">-</span><span class="pln">d jaf<br>cp jaf</span><span class="pun">/</span><span class="pln">jaf</span><span class="pun">-</span><span class="lit">1.1</span><span class="pun">.</span><span class="lit">1</span><span class="pun">/</span><span class="pln">activation</span><span class="pun">.</span><span class="pln">jar </span><span class="pun">/</span><span class="pln">path</span><span class="pun">/</span><span class="pln">to</span><span class="pun">/</span><span class="pln">application</span><span class="pun">/</span><span class="pln">lib<br></span></code></pre></li><li><p>To implement any of the code discussed in this document, use the
   following class template.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">authn</span><span class="pun">.</span><span class="pln">oauth</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Application code here</span><span class="pln"><br><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></li><li><p>Once the above template is in place, continue reading the rest of this
   document, applying the Java code samples as necessary.</p></li></ol></section><section class=""><h3 style="display: none; ">.NET</h3><p>The .NET client library is maintained in an open-source project on Google
    Project hosting.  The .NET library itself is distributed as a MSI installer,
    containing a number of DLLs that applications can import in order to gain
    access to the library.</p><p>The .NET client library requires the .NET Framework 2.0 or greater.</p><p>To setup a development environment for working with the Spreadsheets API,
perform the following steps.</p><ol><li><p>Download the latest <code>Google_Data_API_Setup_*.msi</code> file from the project's
   <a href="http://code.google.com/p/google-gdata/downloads/list">Downloads</a>
   page.  Replace <code>*</code> in this case with something like <code>1.9.0.0</code>.</p></li><li><p>Run the installer and follow the instructions in the setup wizard.</p></li><li><p>To implement any of the code discussed in this document, use the
   following class template.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Application code here</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></li><li><p>Once the above template is in place, continue reading the rest of this
   document, applying the .NET code samples as necessary.</p></li></ol></section></div>
<h2 id="authorizing_requests">Authorizing requests</h2>
<p>When your application requests non-public user data, it must include an
authorization token. The token also identifies your application to Google.</p>
<h3 id="about_authorization_protocols">About authorization protocols</h3>
<p>We recommend using OAuth 2.0 to authorize requests.</p>
<p>The Google Spreadsheets API also supports older authorization options, such as
OAuth 1.0, AuthSub, or ClientLogin; however, in most cases we don't recommend
using those other options. If your application already uses those options, we
recommend migrating to OAuth 2.0 if possible.</p>
<p>If your application has certain unusual authorization requirements, such as
logging in at the same time as requesting data access (hybrid) or domain-wide
delegation of authority (2LO), then you cannot currently use OAuth 2.0 tokens.
In such cases, you must instead use OAuth 1.0 tokens.</p>
<h3 id="authorizing_requests_with_oauth_20">Authorizing requests with OAuth 2.0</h3>
<p>Requests to the Google Spreadsheets API for non-public user data must be
authorized by an authenticated user.</p>
<p>The details of the authorization process, or "flow," for OAuth 2.0 vary
somewhat depending on what kind of application you're writing. The following
general process applies to all application types:</p>
<ol>
<li>When you create your application, you register it with Google. Google then
   provides information you'll need later, such as a client ID and a client
   secret.</li>
<li>Activate the Google Spreadsheets API in the Services pane of the Google APIs
   Console. (If it isn't listed in the Console, then skip this step.)</li>
<li>When your application needs access to user data, it asks Google for a
   particular scope of access.</li>
<li>Google displays an OAuth dialog to the user, asking them to authorize your
   application to request some of their data.</li>
<li>If the user approves, then Google gives your application a short-lived
   access token.</li>
<li>Your application requests user data, attaching the access token to the
   request.</li>
<li>If Google determines that your request and the token are valid, it returns
   the requested data.</li>
</ol>
<p>Some flows include additional steps, such as using refresh tokens to acquire
new access tokens. For detailed information about flows for various types of
applications, see Google's OAuth 2.0 documentation.</p>
<p>Here's the OAuth 2.0 scope information for the Google Spreadsheets API:</p>
<pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds</span><span class="pln"><br></span></code></pre>
<p>Additionally, if an application needs to create spreadsheets, or otherwise
manipulate their metadata, then the application must also request the Google
Documents Lists API scope:</p>
<pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//docs.google.com/feeds</span><span class="pln"><br></span></code></pre>
<p>To request access using OAuth 2.0, your application needs the scope
information, as well as information that Google supplies during application
registration (such as the client ID and/or the client secret).</p>
<h4 id="performing_oauth_20">Performing OAuth 2.0</h4>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section><h3 style="display: none; ">.NET</h3><p>The following example is copied from the google-gdata project's
    <a href="http://code.google.com/p/google-gdata/source/browse/trunk/clients/cs/samples/oauth2_sample/oauth2demo.cs">sample
    directory</a>.
    It has been modified to accommodate the Spreadsheets API, and is provided
    here for ease of reference.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 1: Configure how to perform OAuth 2.0</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Update the following information with that obtained from</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// https://code.google.com/apis/console. After registering</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// your application, these will be provided for you.</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> CLIENT_ID </span><span class="pun">=</span><span class="pln"> </span><span class="str">"12345678.apps.googleusercontent.com"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// This is the OAuth 2.0 Client Secret retrieved</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// above. &nbsp;Be sure to store this value securely. &nbsp;Leaking this</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// value would enable others to act on behalf of your application!</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> CLIENT_SECRET </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Gc0230jdsah01jqpowpgff"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Space separated list of scopes for which to request access.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> SCOPE </span><span class="pun">=</span><span class="pln"> </span><span class="str">"https://spreadsheets.google.com/feeds https://docs.google.com/feeds"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// This is the Redirect URI for installed applications.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// If you are building a web application, you have to set your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Redirect URI at https://code.google.com/apis/console.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> REDIRECT_URI </span><span class="pun">=</span><span class="pln"> </span><span class="str">"urn:ietf:wg:oauth:2.0:oob"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 2: Set up the OAuth 2.0 object</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// OAuth2Parameters holds all the parameters related to OAuth 2.0.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">OAuth2Parameters</span><span class="pln"> parameters </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">OAuth2Parameters</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Set your OAuth 2.0 Client Id (which you can register at</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// https://code.google.com/apis/console).</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; parameters</span><span class="pun">.</span><span class="typ">ClientId</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> CLIENT_ID</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Set your OAuth 2.0 Client Secret, which can be obtained at</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// https://code.google.com/apis/console.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; parameters</span><span class="pun">.</span><span class="typ">ClientSecret</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> CLIENT_SECRET</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Set your Redirect URI, which can be registered at</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// https://code.google.com/apis/console.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; parameters</span><span class="pun">.</span><span class="typ">RedirectUri</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> REDIRECT_URI</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 3: Get the Authorization URL</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Set the scope for this particular service.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; parameters</span><span class="pun">.</span><span class="typ">Scope</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> SCOPE</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the authorization url. &nbsp;The user of your application must visit</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// this url in order to authorize with Google. &nbsp;If you are building a</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// browser-based application, you can redirect the user to the authorization</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// url.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> authorizationUrl </span><span class="pun">=</span><span class="pln"> </span><span class="typ">OAuthUtil</span><span class="pun">.</span><span class="typ">CreateOAuth2AuthorizationUrl</span><span class="pun">(</span><span class="pln">parameters</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">authorizationUrl</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Please visit the URL above to authorize your OAuth "</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">+</span><span class="pln"> </span><span class="str">"request token. &nbsp;Once that is complete, type in your access code to "</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">+</span><span class="pln"> </span><span class="str">"continue..."</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; parameters</span><span class="pun">.</span><span class="typ">AccessCode</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">ReadLine</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 4: Get the Access Token</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Once the user authorizes with Google, the request token can be exchanged</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// for a long-lived access token. &nbsp;If you are building a browser-based</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// application, you should parse the incoming request token from the url and</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// set it in OAuthParameters before calling GetAccessToken().</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">OAuthUtil</span><span class="pun">.</span><span class="typ">GetAccessToken</span><span class="pun">(</span><span class="pln">parameters</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> accessToken </span><span class="pun">=</span><span class="pln"> parameters</span><span class="pun">.</span><span class="typ">AccessToken</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"OAuth Access Token: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> accessToken</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 5: Make an OAuth authorized request to Google</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Initialize the variables needed to make the request</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">GOAuth2RequestFactory</span><span class="pln"> requestFactory </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GOAuth2RequestFactory</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">,</span><span class="pln"> parameters</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; service</span><span class="pun">.</span><span class="typ">RequestFactory</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> requestFactory</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make the request to Google</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// See other portions of this guide for code to put here...</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h3 id="authorizing_requests_with_oauth_10a">Authorizing requests with OAuth 1.0a</h3>
<p class="alert-message special"><strong>Important:</strong><span> Before proceeding, please read the
<a href="https://developers.google.com/accounts/docs/OAuth">documentation</a> describing
the OAuth 1.0a web flow.  Understanding the flow of OAuth 1.0a, and what occurs
in a client's web browser while authorizing the Spreadsheets API, is imperative
to ensure an application functions correctly.</span></p>
<p>As with OAuth 2.0, the scope to request for OAuth 1.0a while working with the
Spreadsheets API is:</p>
<pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds</span><span class="pln"><br></span></code></pre>
<p>Again, if an application needs to create spreadsheets, or otherwise manipulate
their metadata, then the application must also request the Google Documents
Lists API scope:</p>
<pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//docs.google.com/feeds</span><span class="pln"><br></span></code></pre>
<p>As mentioned previously, the Java client library does not currently support
OAuth 2.0.  Instead, to authorize with OAuth 1.0a, use the following code.</p>
<h4 id="performing_3-legged_oauth_10a_oauth_10a_for_web_applications">Performing 3-Legged OAuth 1.0a (OAuth 1.0a for Web Applications)</h4>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following example is copied from the gdata-java-client project's
    <a href="http://code.google.com/p/gdata-java-client/source/browse/trunk/java/sample/oauth/OAuthExample.java">sample
    directory</a>.
    It has been modified to accommodate the Spreadsheets API, and is provided
    here for ease of reference.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">authn</span><span class="pun">.</span><span class="pln">oauth</span><span class="pun">.</span><span class="typ">GoogleOAuthHelper</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">authn</span><span class="pun">.</span><span class="pln">oauth</span><span class="pun">.</span><span class="typ">GoogleOAuthParameters</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">authn</span><span class="pun">.</span><span class="pln">oauth</span><span class="pun">.</span><span class="typ">OAuthHmacSha1Signer</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">authn</span><span class="pun">.</span><span class="pln">oauth</span><span class="pun">.</span><span class="typ">OAuthRsaSha1Signer</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">authn</span><span class="pun">.</span><span class="pln">oauth</span><span class="pun">.</span><span class="typ">OAuthSigner</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="typ">Link</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">.</span><span class="typ">BatchOperationType</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">.</span><span class="typ">BatchStatus</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">.</span><span class="typ">BatchUtils</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// STEP 1: Configure how to perform OAuth 1.0a</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">boolean</span><span class="pln"> USE_RSA_SIGNING </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Update the following information with that obtained from</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// https://www.google.com/accounts/ManageDomains. After registering</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// your application, these will be provided for you.</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> CONSUMER_KEY </span><span class="pun">=</span><span class="pln"> </span><span class="str">"yourappdomain.com"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Replace this with base-64 encoded private key conforming</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// to PKCS #8 standard, if and only if you will use RSA-SHA1</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// signing. &nbsp;Otherwise, this is the OAuth Consumer Secret retrieved</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// above. &nbsp;Be sure to store this value securely. &nbsp;Leaking this</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// value would enable others to act on behalf of your application!</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> CONSUMER_SECRET </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Gc0230jdsah01jqpowpgff"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Space separated list of scopes for which to request access.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> SCOPES </span><span class="pun">=</span><span class="pln"> </span><span class="str">"https://spreadsheets.google.com/feeds https://docs.google.com/feeds"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// STEP 2: Set up the OAuth objects</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// You first need to initialize a few OAuth-related objects.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// GoogleOAuthParameters holds all the parameters related to OAuth.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// OAuthSigner is responsible for signing the OAuth base string.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GoogleOAuthParameters</span><span class="pln"> oauthParameters </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GoogleOAuthParameters</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Set your OAuth Consumer Key (which you can register at</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// https://www.google.com/accounts/ManageDomains).</span><span class="pln"><br>&nbsp; &nbsp; oauthParameters</span><span class="pun">.</span><span class="pln">setOAuthConsumerKey</span><span class="pun">(</span><span class="pln">CONSUMER_KEY</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Initialize the OAuth Signer. &nbsp;If you are using RSA-SHA1, you must provide</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// your private key as a Base-64 string conforming to the PKCS #8 standard.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// Visit http://code.google.com/apis/gdata/authsub.html#Registered to learn</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// more about creating a key/certificate pair. &nbsp;If you are using HMAC-SHA1,</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// you must set your OAuth Consumer Secret, which can be obtained at</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// https://www.google.com/accounts/ManageDomains.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">OAuthSigner</span><span class="pln"> signer</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">USE_RSA_SIGNING</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; signer </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">OAuthRsaSha1Signer</span><span class="pun">(</span><span class="pln">CONSUMER_SECRET</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; oauthParameters</span><span class="pun">.</span><span class="pln">setOAuthConsumerSecret</span><span class="pun">(</span><span class="pln">CONSUMER_SECRET</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; signer </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">OAuthHmacSha1Signer</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Finally, create a new GoogleOAuthHelperObject. &nbsp;This is the object you</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// will use for all OAuth-related interaction.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">GoogleOAuthHelper</span><span class="pln"> oauthHelper </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GoogleOAuthHelper</span><span class="pun">(</span><span class="pln">signer</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// STEP 3: Get the Authorization URL</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Set the scope for this particular service.</span><span class="pln"><br>&nbsp; &nbsp; oauthParameters</span><span class="pun">.</span><span class="pln">setScope</span><span class="pun">(</span><span class="pln">SCOPES</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// This method also makes a request to get the unauthorized request token,</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// and adds it to the oauthParameters object, along with the token secret</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// (if it is present).</span><span class="pln"><br>&nbsp; &nbsp; oauthHelper</span><span class="pun">.</span><span class="pln">getUnauthorizedRequestToken</span><span class="pun">(</span><span class="pln">oauthParameters</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the authorization url. &nbsp;The user of your application must visit</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// this url in order to authorize with Google. &nbsp;If you are building a</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// browser-based application, you can redirect the user to the authorization</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// url.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> requestUrl </span><span class="pun">=</span><span class="pln"> oauthHelper</span><span class="pun">.</span><span class="pln">createUserAuthorizationUrl</span><span class="pun">(</span><span class="pln">oauthParameters</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">requestUrl</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"Please visit the URL above to authorize your OAuth "</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">+</span><span class="pln"> </span><span class="str">"request token. &nbsp;Once that is complete, press any key to "</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">+</span><span class="pln"> </span><span class="str">"continue..."</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">in</span><span class="pun">.</span><span class="pln">read</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// STEP 4: Get the Access Token</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Once the user authorizes with Google, the request token can be exchanged</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// for a long-lived access token. &nbsp;If you are building a browser-based</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// application, you should parse the incoming request token from the url and</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// set it in GoogleOAuthParameters before calling getAccessToken().</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> token </span><span class="pun">=</span><span class="pln"> oauthHelper</span><span class="pun">.</span><span class="pln">getAccessToken</span><span class="pun">(</span><span class="pln">oauthParameters</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"OAuth Access Token: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> token</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// STEP 5: Make an OAuth authorized request to Google</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Initialize the variables needed to make the request</span><span class="pln"><br>&nbsp; &nbsp; URL feedUrl </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln">variables</span><span class="pun">.</span><span class="pln">getFeedUrl</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"Sending request to "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> feedUrl</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Set the OAuth credentials which were obtained from the step above.</span><span class="pln"><br>&nbsp; &nbsp; service</span><span class="pun">.</span><span class="pln">setOAuthCredentials</span><span class="pun">(</span><span class="pln">oauthParameters</span><span class="pun">,</span><span class="pln"> signer</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make the request to Google</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// See other portions of this guide for code to put here...</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// STEP 6: Revoke the OAuth token</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"Revoking OAuth Token..."</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; oauthHelper</span><span class="pun">.</span><span class="pln">revokeToken</span><span class="pun">(</span><span class="pln">oauthParameters</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"OAuth Token revoked..."</span><span class="pun">);</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 1: Configure how to perform OAuth 1.0a</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Update the following information with that obtained from</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// https://www.google.com/accounts/ManageDomains. After registering</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// your application, these will be provided for you.</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> CONSUMER_KEY </span><span class="pun">=</span><span class="pln"> </span><span class="str">"yourappdomain.com"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// This is the OAuth Consumer Secret retrieved</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// above. &nbsp;Be sure to store this value securely. &nbsp;Leaking this</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// value would enable others to act on behalf of your application!</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> CONSUMER_SECRET </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Gc0230jdsah01jqpowpgff"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Space separated list of scopes for which to request access.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> SCOPE </span><span class="pun">=</span><span class="pln"> </span><span class="str">"https://spreadsheets.google.com/feeds https://docs.google.com/feeds"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 2: Set up the OAuth object</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// OAuthParameters holds all the parameters related to OAuth.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">OAuthParameters</span><span class="pln"> parameters </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">OAuthParameters</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Set your OAuth Consumer Key (which you can register at</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// https://www.google.com/accounts/ManageDomains).</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; parameters</span><span class="pun">.</span><span class="typ">ConsumerKey</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> CONSUMER_KEY</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Set your OAuth Consumer Secret, which can be obtained at</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// https://www.google.com/accounts/ManageDomains.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; parameters</span><span class="pun">.</span><span class="typ">ConsumerSecret</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> CONSUMER_SECRET</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// HMAC-SHA1 is the only signature method supported by the .NET library.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; parameters</span><span class="pun">.</span><span class="typ">SignatureMethod</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="typ">OAuthBase</span><span class="pun">.</span><span class="pln">HMACSHA1SignatureType</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 3: Get the Authorization URL</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Set the scope for this particular service.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; parameters</span><span class="pun">.</span><span class="typ">Scope</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> SCOPE</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// This method also makes a request to get the unauthorized request token,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// and adds it to the oauthParameters object, along with the token secret</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// (if it is present).</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">OAuthUtil</span><span class="pun">.</span><span class="typ">GetUnauthorizedRequestToken</span><span class="pun">(</span><span class="pln">parameters</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the authorization url. &nbsp;The user of your application must visit</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// this url in order to authorize with Google. &nbsp;If you are building a</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// browser-based application, you can redirect the user to the authorization</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// url.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> authorizationUrl </span><span class="pun">=</span><span class="pln"> </span><span class="typ">OAuthUtil</span><span class="pun">.</span><span class="typ">CreateUserAuthorizationUrl</span><span class="pun">(</span><span class="pln">parameters</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">authorizationUrl</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Please visit the URL above to authorize your OAuth "</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">+</span><span class="pln"> </span><span class="str">"request token. &nbsp;Once that is complete, press any key to "</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">+</span><span class="pln"> </span><span class="str">"continue..."</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">ReadLine</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 4: Get the Access Token</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Once the user authorizes with Google, the request token can be exchanged</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// for a long-lived access token. &nbsp;If you are building a browser-based</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// application, you should parse the incoming request token from the url and</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// set it in OAuthParameters before calling GetAccessToken().</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">OAuthUtil</span><span class="pun">.</span><span class="typ">GetAccessToken</span><span class="pun">(</span><span class="pln">parameters</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> accessToken </span><span class="pun">=</span><span class="pln"> parameters</span><span class="pun">.</span><span class="typ">Token</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"OAuth Access Token: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> accessToken</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// STEP 5: Make an OAuth authorized request to Google</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">////////////////////////////////////////////////////////////////////////////</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Initialize the variables needed to make the request</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">GOAuthRequestFactory</span><span class="pln"> requestFactory </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GOAuthRequestFactory</span><span class="pun">(</span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> </span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">,</span><span class="pln"> parameters</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; service</span><span class="pun">.</span><span class="typ">RequestFactory</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> requestFactory</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make the request to Google</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// See other portions of this guide for code to put here...</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h3 id="authorizing_requests_with_clientlogin">Authorizing requests with ClientLogin</h3>
<p class="alert-message warning"><strong>Warning:</strong><span> The use of ClientLogin as an authorization mechanism is strongly
discouraged.  Before using this mechanism, please thoroughly consider using
OAuth 2.0 with a stored refresh token or OAuth 1.0a with a stored access token.</span></p>
<p>ClientLogin allows applications to make requests to the Spreadsheets API using
the username and application-specific password of a Google account.  When using
this mechanism, applications must take extreme caution when handling these
credentials, as leaking the credentials could have severe consequences.  Any
application experiencing a security concern should immediately notify affected
users.</p>
<p>To implement the ClientLogin mechanism, make an authorized request to the
Spreadsheets API, with the appropriate <code>Authorization</code> header.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>Detailed information on implementing ClientLogin from a protocol
    perspective is available
    <a href="https://developers.google.com/accounts/docs/AuthForInstalledApps">here</a>.</p><p>When fetching a ClientLogin token for the Spreadsheets API, be sure to use
the <code>wise</code> service name.</p></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following is a code sample in which a <code>SpreadsheetService</code> object is
    configured to use ClientLogin for authorization.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> USERNAME </span><span class="pun">=</span><span class="pln"> </span><span class="str">"someuser@gmail.com"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> PASSWORD </span><span class="pun">=</span><span class="pln"> </span><span class="str">"testing123"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; service</span><span class="pun">.</span><span class="pln">setUserCredentials</span><span class="pun">(</span><span class="pln">USERNAME</span><span class="pun">,</span><span class="pln"> PASSWORD</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: See other portions of this guide for code to put here...</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following is a code sample in which a <code>SpreadsheetService</code> object is
    configured to use ClientLogin for authorization.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> USERNAME </span><span class="pun">=</span><span class="pln"> </span><span class="str">"someuser@gmail.com"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> PASSWORD </span><span class="pun">=</span><span class="pln"> </span><span class="str">"testing123"</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; service</span><span class="pun">.</span><span class="pln">setUserCredentials</span><span class="pun">(</span><span class="pln">USERNAME</span><span class="pun">,</span><span class="pln"> PASSWORD</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: See other portions of this guide for code to put here...</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h2 id="specifying_a_version">Specifying a version</h2>
<p>Every request sent to the Google Spreadsheets API can optionally specify that
the request is for version 3.0 of the API, although this is not necessary.</p>
<p class="alert-message info note"><strong>Note:</strong><span> The client libraries for the Google Spreadsheets API automatically set
the appropriate version header.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value="python" class="kd-tabbutton">Python</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To specify a version number, use the <code>GData-Version</code> HTTP header.</p><pre class="prettyprint"><code><span class="typ">GData</span><span class="pun">-</span><span class="typ">Version</span><span class="pun">:</span><span class="pln"> </span><span class="lit">3.0</span><span class="pln"><br></span></code></pre><p>Alternatively, version 3.0 can be specified as a URL parameter.</p><pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/spreadsheets/private/full?v=3.0</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>Version <code>3.0</code> is specified by default in the GData Java client library.
    Java developers do not need to do anything to specify a version.</p><p>In the rare circumstance an application may need to specify another version,
the line of code to do so reads:</p><pre class="prettyprint"><code><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration"</span><span class="pun">);</span><span class="pln"><br>service</span><span class="pun">.</span><span class="pln">setProtocolVersion</span><span class="pun">(</span><span class="typ">SpreadsheetService</span><span class="pun">.</span><span class="typ">Versions</span><span class="pun">.</span><span class="pln">V3</span><span class="pun">);</span><span class="pln"><br></span><span class="com">//service.setProtocolVersion(SpreadsheetService.Versions.V2);</span><span class="pln"><br></span><span class="com">//service.setProtocolVersion(SpreadsheetService.Versions.V1);</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Python</h3><p>Version <code>3.0</code> is specified by default in the GData Python client library.
    Python developers do not need to do anything to specify a version.</p></section><section><h3 style="display: none; ">.NET</h3><p>Version <code>3.0</code> is specified by default in the GData .NET client library.
    .NET developers do not need to do anything to specify a version.</p></section></div>
<h2 id="creating_a_spreadsheet">Creating a spreadsheet</h2>
<p>It is possible to create a new spreadsheet by uploading a spreadsheet file via
the <a href="https://developers.google.com/google-apps/documents-list/">Google Documents List
API</a>. The
Spreadsheets API does not currently provide a way to delete a spreadsheet, but
this is also provided in the Documents List API.  For testing purposes, you may
create a spreadsheet manually or upload one.</p>
<h2 id="spreadsheets_api_urls_visibilities_and_projections">Spreadsheets API URLs, visibilities, and projections</h2>
<p>The Spreadsheets API supports visibilities and projections in request URLs.
Visibilities determine whether or not authorization should be used for a
request.  Projections determine which data is returned in a response to a
request.  Visibilities and projections are set in request URLs to the API.</p>
<p>An example Spreadsheets API URL reads:</p>
<pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/worksheets/key/private/full</span><span class="pln"><br></span></code></pre>
<p>URLs similar to that one are returned by the Spreadsheets API in various link
elements in feed responses.  When working with the API, applications can change
the keywords <code>private</code> and <code>full</code>, in order to manipulate API functionality
slightly.  URLs returned by the API after having changed these keywords will
reflect the keywords used in the source request.</p>
<p>That is, if the following request is made to the API:</p>
<pre class="prettyprint"><code><span class="pln">GET https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/worksheets/key/private/basic</span><span class="pln"><br></span></code></pre>
<p>Then the cells feed URLs in each worksheet entry are of the form:</p>
<pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/cells/key/worksheetId/private/basic</span><span class="pln"><br></span></code></pre>
<p>And the list feed URLs in each worksheet entry are of the form:</p>
<pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/list/key/worksheetId/private/basic</span><span class="pln"><br></span></code></pre>
<p>Note that the <code>basic</code> projection is already set on these generated URLs.  The
same applies for the <code>public</code> visibility described below.</p>
<p>There are other visibility and projection values available besides <code>private</code>
and <code>full</code>.</p>
<p>The <code>private</code> visibility can be replaced with the <code>public</code> visibility, which
enables the feed to work without authorization for spreadsheets that have been
"Published to the Web".  The <code>public</code> visibility is supported on the
worksheets, list, and cells feeds.  The <code>public</code> visibility is useful for
accessing the contents of a spreadsheet from the client context of a web page
in JavaScript, for example.</p>
<p>Publishing a spreadsheet to the web can only be done from the Google
Spreadsheets user interface.  To start publishing a spreadsheet to the web,
select <code>File &gt; Publish to the web</code> from the Spreadsheets user interface, and
then click the <code>Start Publishing</code> button.</p>
<p class="alert-message warning"><strong>Warning:</strong><span> API requests using the <code>public</code> visiblity for feeds on spreadsheets
that are not "Published to the Web" yield an HTTP <code>400 Bad Request</code> response
with the message <code>The spreadsheet at this URL could not be found. Make sure
that you have the right URL and that the owner of the spreadsheet hasn't
deleted it.</code></span></p>
<p class="alert-message warning"><strong>Warning:</strong><span> The <code>public</code> visibility does not work for spreadsheets that are made
"Public on the web" from the "Visibility options" portion of the sharing dialog
of a Google Spreadsheet.  "Published to the web" and "Public on the web" are
different ways to share a spreadsheet.  We are aware that this is confusing,
and will address it in a future version of the API.  For now, we hope that this
detailed warning prevents confusion.</span></p>
<p>The <code>full</code> projection can be replaced with the <code>basic</code> projection, causing the
feed to return less information (i.e. fewer fields, and only the most important
data).  This is better for low-bandwidth environments.  The <code>basic</code> projection
is supported on the worksheets, list, and cells feeds.</p>
<h2 id="retrieving_a_list_of_spreadsheets">Retrieving a list of spreadsheets</h2>
<p>The Google Spreadsheets API supports fetching a list of spreadsheets for the
authenticated user. Note however that you cannot create or delete spreadsheets
via this API. For those operations, you must use the <a href="https://developers.google.com/google-apps/documents-list?hl=es">Google Documents List
API</a>.</p>
<p>This API operation is accessible only with authorized requests.  Requests that
have not been authorized cannot access this feed (i.e. this feed is not
public).</p>
<p class="alert-message info note"><strong>Note:</strong><span> The spreadsheets feed only supports the <code>private</code> visibility and the
<code>full</code> projection.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>You can request a feed containing a list of the currently authenticated
    user's spreadsheets by sending an authenticated <code>GET</code> request to the
    following URL:</p><pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/spreadsheets/private/full</span><span class="pln"><br></span></code></pre><p>The result is a feed that lists all of user's spreadsheets.</p><p>An entry in the spreadsheets feed might resemble the following. The
following example has been edited a little to make it a little more
readable by humans; in particular, a real spreadsheets feed contains actual
spreadsheet IDs where the following listing says key.</p><pre class="prettyprint"><code><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">""</span><span class="atn">FDHGCHnx12</span><span class="atv">""</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/spreadsheets/tNXTXMh83yMWLVJfEgOWTvQ</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2011-05-27T15:08:37.102Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;category</span><span class="pln"> </span><span class="atn">scheme</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"> </span><span class="atn">term</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#spreadsheet"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;title&gt;</span><span class="pln">My Spreadsheet</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml;type=feed"</span><span class="pln"> </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/worksheets/tNXTXMh83yMWLVJfEgOWTvQ/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#tablesfeed"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/tNXTXMh83yMWLVJfEgOWTvQ/tables"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"alternate"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/html"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/ccc?key=0Ak8c_1IVge120199weAHSjDHf1XTFZKZkVnT1dUdlE"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/spreadsheets/private/full/tNXTXMh83yMWLVJfEgOWTvQ"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;author&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;name&gt;</span><span class="pln">joe</span><span class="tag">&lt;/name&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;email&gt;</span><span class="pln">joe@yourdomain.com</span><span class="tag">&lt;/email&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/author&gt;</span><span class="pln"><br></span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br></span></code></pre><p>Note that the key value that appears here is the same as the key value that
appears in the URL displayed in the address bar of your browser window when
you open the spreadsheet manually.</p><p>The URI given in the <code>link</code> element with
<code>rel="http://schemas.google.com/spreadsheets/2006#tablesfeed"</code> is the
URI of the worksheets feed for that spreadsheet, which lists all the
worksheets the user has access to in that spreadsheet. If that URI ends
with <code>/private/values</code>, that indicates that the current authenticated user
can only view the spreadsheet, not edit it. If it ends with
<code>/private/full</code>, that indicates that the current authenticated user is
authorized to add and edit data in the worksheets.</p><p class="alert-message info note"><strong>Note:</strong><span> User access levels are set in the GUI. If a user owns a given
worksheet or is listed as an editor, then they have read/write access; if
they're listed only as a viewer, then they have read-only access. In
addition, if the worksheet is published then even unauthenticated users and
users not listed as viewers have read access.</span></p></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code fetches a list of all spreadsheets owned or shared with
    an authorized user, and prints out the title of each spreadsheet.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"> </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Iterate through all of the spreadsheets returned</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">:</span><span class="pln"> spreadsheets</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the title of this spreadsheet to the screen</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code fetches a list of all spreadsheets owned or shared with an
    authorized user, and prints out the title of each spreadsheet.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Iterate through all of the spreadsheets returned</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pln"> entry </span><span class="kwd">in</span><span class="pln"> feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the title of this spreadsheet to the screen</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">entry</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<p>If no entries are returned, it means there are no spreadsheets created or
shared by this account. Creating a spreadsheet and requesting the feed again
yields a spreadsheet entry.</p>
<h2 id="working_with_worksheets">Working with worksheets</h2>
<p>A given spreadsheet may contain multiple worksheets. Each spreadsheet has a
worksheets feed listing all of its worksheets.</p>
<p>The following sections describe how to get a set of worksheets, add a worksheet
to a spreadsheet, update the metadata of a worksheet, and remove a worksheet
from the spreadsheet.</p>
<h3 id="retrieving_information_about_worksheets">Retrieving information about worksheets</h3>
<p>A set of metadata can be fetched about each worksheet, as well as information
that enables further manipulation of data in the worksheet.</p>
<p class="alert-message info note"><strong>Note:</strong><span> The worksheets feed supports the <code>private</code> and <code>public</code> visibilities, and
both the <code>full</code> and <code>basic</code> projections.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To determine the URL of a given spreadsheet's worksheets feed, find that
    spreadsheet's entry in the spreadsheets feed, as described in the previous
    section. Then examine the <code>link</code> element that has
    <code>rel="http://schemas.google.com/spreadsheets/2006#tablesfeed"</code>. That
    element's href value provides the URL for that spreadsheet's worksheets
    feed.</p><p>To request a list of worksheets in a given spreadsheet, issue a <code>GET</code>
request to that URL, with an appropriate authorization header:</p><pre class="prettyprint"><code><span class="pln">GET https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/worksheets/key/private/full</span><span class="pln"><br></span></code></pre><p>The API returns a feed resembling the following.  The word <code>key</code> in the
following example is used only to make the sample more readable.</p><pre class="prettyprint"><code><span class="tag">&lt;feed</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2005/Atom"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:openSearch</span><span class="pun">=</span><span class="atv">"http://a9.com/-/spec/opensearch/1.1/"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:gs</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:gd</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/g/2005"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'W/"D0cERnk-eip7ImA9WBBXGEg."'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/worksheets/key/private/full</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:23:45.173Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Groceries R Us</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"alternate"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/html"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/ccc?key=key"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/g/2005#feed"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/worksheets/key/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/worksheets/key/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/g/2005#post"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/worksheets/key/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;author&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;name&gt;</span><span class="pln">Fitzwilliam Darcy</span><span class="tag">&lt;/name&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;email&gt;</span><span class="pln">fitz@gmail.com</span><span class="tag">&lt;/email&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/author&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;openSearch:totalResults&gt;</span><span class="pln">1</span><span class="tag">&lt;/openSearch:totalResults&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;openSearch:startIndex&gt;</span><span class="pln">1</span><span class="tag">&lt;/openSearch:startIndex&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;openSearch:itemsPerPage&gt;</span><span class="pln">1</span><span class="tag">&lt;/openSearch:itemsPerPage&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'"YDwqeyI."'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/worksheets/key/private/full/worksheetId</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:23:45.173Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Sheet1</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Sheet1</span><span class="tag">&lt;/content&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#listfeed"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#cellsfeed"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/worksheets/key/private/full/worksheetId"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/worksheets/key/private/full/worksheetId/version"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gs:rowCount&gt;</span><span class="pln">100</span><span class="tag">&lt;/gs:rowCount&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gs:colCount&gt;</span><span class="pln">20</span><span class="tag">&lt;/gs:colCount&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br></span><span class="tag">&lt;/feed&gt;</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code fetches a list of worksheets for the first spreadsheet
    in a feed.  It first prints out the title of the spreadsheet, and then
    prints a list of all worksheets in that spreadsheet.  Each item in the
    list shows the title, number of rows, and number of columns of the
    worksheet.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API to fetch information about all</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// worksheets in the spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheets</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Iterate through each worksheet in the spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">:</span><span class="pln"> worksheets</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the worksheet's title, row count, and column count.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> title </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> rowCount </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="pln">getRowCount</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> colCount </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="pln">getColCount</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the fetched information to the screen for this worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="str">"\t"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> title </span><span class="pun">+</span><span class="pln"> </span><span class="str">"- rows:"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> rowCount </span><span class="pun">+</span><span class="pln"> </span><span class="str">" cols: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> colCount</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code fetches a list of worksheets for the first spreadsheet
    in a feed.  It first prints out the title of the spreadsheet, and then
    prints a list of all worksheets in that spreadsheet.  Each worksheet in the
    list shows the title, number of rows, and number of columns of the
    worksheet.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API to fetch information about all</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// worksheets in the spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Iterate through each worksheet in the spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pln"> entry </span><span class="kwd">in</span><span class="pln"> wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Get the worksheet's title, row count, and column count.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> title </span><span class="pun">=</span><span class="pln"> entry</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> rowCount </span><span class="pun">=</span><span class="pln"> entry</span><span class="pun">.</span><span class="typ">Rows</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> colCount </span><span class="pun">=</span><span class="pln"> entry</span><span class="pun">.</span><span class="typ">Cols</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the fetched information to the screen for this worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">title </span><span class="pun">+</span><span class="pln"> </span><span class="str">"- rows:"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> rowCount </span><span class="pun">+</span><span class="pln"> </span><span class="str">" cols: "</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> colCount</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h3 id="adding_a_worksheet">Adding a worksheet</h3>
<p>Worksheets can be created using the Spreadsheets API. To do this, an
application must make a request to the API containing information about the new
worksheet, like its title and initial size.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To add a worksheet to the spreadsheet, authenticate and authorize, then
    simply make the following HTTP request to a spreadsheet's worksheet feed
    URL. You must be authenticated and authorized to add worksheets via the
    Spreadsheets API.</p><pre class="prettyprint"><code><span class="pln">POST https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/worksheets/key/private/full</span><span class="pln"><br></span><span class="typ">Content</span><span class="pun">-</span><span class="typ">Type</span><span class="pun">:</span><span class="pln"> application</span><span class="pun">/</span><span class="pln">atom</span><span class="pun">+</span><span class="pln">xml<br><br></span><span class="pun">&lt;</span><span class="pln">entry xmlns</span><span class="pun">=</span><span class="str">"http://www.w3.org/2005/Atom"</span><span class="pln"><br>&nbsp; &nbsp; xmlns</span><span class="pun">:</span><span class="pln">gs</span><span class="pun">=</span><span class="str">"http://schemas.google.com/spreadsheets/2006"</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; </span><span class="str">&lt;title&gt;</span><span class="typ">Expenses</span><span class="pun">&lt;</span><span class="str">/title&gt;<br>&nbsp; &lt;gs:rowCount&gt;50&lt;/</span><span class="pln">gs</span><span class="pun">:</span><span class="pln">rowCount</span><span class="pun">&gt;</span><span class="pln"><br>&nbsp; </span><span class="pun">&lt;</span><span class="pln">gs</span><span class="pun">:</span><span class="pln">colCount</span><span class="pun">&gt;</span><span class="lit">10</span><span class="pun">&lt;</span><span class="str">/gs:colCount&gt;<br>&lt;/</span><span class="pln">entry</span><span class="pun">&gt;</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code adds a new worksheet to the first spreadsheet returned
    from the API.  The title of the created worksheet is <code>New Worksheet</code>.  The
    new worksheet has 10 columns and 20 rows.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Create a local representation of the new worksheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">WorksheetEntry</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="pln">setTitle</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PlainTextConstruct</span><span class="pun">(</span><span class="str">"New Worksheet"</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="pln">setColCount</span><span class="pun">(</span><span class="lit">10</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="pln">setRowCount</span><span class="pun">(</span><span class="lit">20</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Send the local representation of the worksheet to the API for</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// creation. &nbsp;The URL to use here is the worksheet feed URL of our</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; URL worksheetFeedUrl </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; service</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">worksheetFeedUrl</span><span class="pun">,</span><span class="pln"> worksheet</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code adds a new worksheet to the first spreadsheet returned
    from the API.  The title of the created worksheet is <code>New Worksheet</code>.  The
    new worksheet has 10 columns and 20 rows.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Create a local representation of the new worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">WorksheetEntry</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"New Worksheet"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="typ">Cols</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">10</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="typ">Rows</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">20</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Send the local representation of the worksheet to the API for</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// creation. &nbsp;The URL to use here is the worksheet feed URL of our</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; service</span><span class="pun">.</span><span class="typ">Insert</span><span class="pun">(</span><span class="pln">wsFeed</span><span class="pun">,</span><span class="pln"> worksheet</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<p>The new worksheet will appear after the last worksheet in the Spreadsheets UI.</p>
<p class="alert-message special"><strong>Important:</strong><span> It is currently not possible to set the order of worksheets in the
UI via the Spreadsheets API, outside of deleting and recreating all worksheets.</span></p>
<h3 id="modifying_a_worksheets_title_and_size">Modifying a worksheet's title and size</h3>
<p>You can modify the title and size of a worksheet with the Spreadsheets API by
sending a request to the API containing the new properties of the worksheet. If
you need to modify the actual content of cells, see <a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#adding_a_list_row">Adding a list
row</a>, or <a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#changing_contents_of_a_cell">Changing contents of a
cell</a>.</p>
<p class="alert-message info note"><strong>Note:</strong><span> Metadata includes the title of the worksheet and the number of rows and
columns.</span></p>
<p class="alert-message warning"><strong>Warning:</strong><span> Setting the number of rows or columns to less than the original will
delete the cells and contents that do not exist within the new boundaries
WITHOUT WARNING.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To change the title or size of a worksheet, begin by getting the desired
    worksheet from the worksheet feed. Then update the worksheet's metadata and
    send a <code>PUT</code> request with the desired entry contents to the URL provided in
    an edit link. The <code>edit</code> URL is highlighted in the XML below.</p><pre class="prettyprint"><code><span class="tag">&lt;entry&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln"><br>&nbsp; &nbsp; https://spreadsheets.google.com/feeds/worksheets/key/private/full/worksheetId<br>&nbsp; </span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2007-07-30T18:51:30.666Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;category</span><span class="pln"> </span><span class="atn">scheme</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">term</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#worksheet"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Income</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Expenses</span><span class="tag">&lt;/content&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#listfeed"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#cellsfeed"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"> </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/worksheets/key/private/full/worksheetId"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/worksheets/key/private/full/worksheetId/version"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gs:rowCount&gt;</span><span class="pln">45</span><span class="tag">&lt;/gs:rowCount&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gs:colCount&gt;</span><span class="pln">15</span><span class="tag">&lt;/gs:colCount&gt;</span><span class="pln"><br></span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code changes the title and dimensions of the first worksheet
    returned for the first spreadsheet in the spreadsheets feed.  The title of
    the worksheet is changed to <code>Updated Worksheet</code>, the number of columns is
    set to 5, and the number of rows is set to 15.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> worksheetFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">(),</span><span class="pln"> </span><span class="typ">WorksheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> worksheetFeed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> worksheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Update the local representation of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="pln">setTitle</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">PlainTextConstruct</span><span class="pun">(</span><span class="str">"Updated Worksheet"</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="pln">setColCount</span><span class="pun">(</span><span class="lit">5</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="pln">setRowCount</span><span class="pun">(</span><span class="lit">15</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Send the local representation of the worksheet to the API for</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// modification.</span><span class="pln"><br>&nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="pln">update</span><span class="pun">();</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code changes the title and dimensions of the first worksheet
    returned for the first spreadsheet in the spreadsheets feed.  The title of
    the worksheet is changed to <code>Updated Worksheet</code>, the number of columns is
    set to 5, and the number of rows is set to 15.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pun">)</span><span class="pln">wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Update the local representation of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Updated Worksheet"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="typ">Cols</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="typ">Rows</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">15</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Send the local representation of the worksheet to the API for</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// modification.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="typ">Update</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h3 id="deleting_a_worksheet">Deleting a worksheet</h3>
<p>Worksheets can be deleted from a spreadsheet using the Spreadsheets API.</p>
<p>When a worksheet is deleted, all worksheets to the right of it in the
Spreadsheets UI will be shifted left one position.  The ID of the other
worksheets will not change, however.</p>
<p class="alert-message warning"><strong>Warning:</strong><span> If you delete a worksheet, that worksheet is completely removed from
the spreadsheet and all data contained on that worksheet is discarded.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To delete a worksheet, perform a <code>DELETE</code> request on the <code>edit</code> URL of a
    worksheet entry after obtaining it as described above.</p><pre class="prettyprint"><code><span class="pln">DELETE https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/worksheets/key/private/full/worksheetId/version</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code deletes the first worksheet returned for the first
    spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> worksheetFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">(),</span><span class="pln"> </span><span class="typ">WorksheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> worksheetFeed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> worksheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Delete the worksheet via the API.</span><span class="pln"><br>&nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="kwd">delete</span><span class="pun">();</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code deletes the first worksheet returned for the first
    spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pun">)</span><span class="pln">wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Delete the worksheet via the API.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; worksheet</span><span class="pun">.</span><span class="typ">Delete</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h2 id="working_with_list-based_feeds">Working with list-based feeds</h2>
<p>A given worksheet generally contains multiple rows, each containing multiple
cells. You can request data from the worksheet either as a list-based feed, in
which each entry represents a row, or as a cell-based feed, in which each entry
represents a single cell. For information on cell-based feeds, see <a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#working_with_cell-based_feeds">Working
with cell-based feeds</a>.</p>
<p>The following sections describe how to get a list-based feed of rows in a
worksheet, and how to manage those rows.  Also discussed is how to query for
specific rows in a worksheet using advanced query parameters.</p>
<p class="alert-message warning"><strong>Warning:</strong><span> The list feed writes static values into cells that have formulas
applied to them.  To modify cells with formulas while keeping the formulas
applied, use the <a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#working_with_cell-based_feeds">Cells feed</a>.</span></p>
<p>The list feed makes some assumptions about how the data is laid out in the
spreadsheet.</p>
<p>In particular, the list feed treats the first row of the worksheet as a header
row. The API dynamically creates XML elements named after the contents of
header-row cells. Users needing list-based API feed access to a worksheet must
only put column headers in the first row of the worksheet.</p>
<p class="alert-message warning"><strong>Warning:</strong><span> If users modify the contents of the header row in a worksheet, an
application may break.</span></p>
<p>Applications needing to dynamically determine the contents of the header row
must use the <a href="https://developers.google.com/google-apps/spreadsheets/?hl=es#working_with_cell-based_feeds">Cells feed</a> to access the
contents of the header row by its position.</p>
<p class="alert-message special"><strong>Important:</strong><span> For a column to be accessible in a list feed, it must have data in
its header cell.  Columns without data in the header cell are not exposed in
the list feed.</span></p>
<h3 id="retrieving_a_list-based_feed">Retrieving a list-based feed</h3>
<p>The list feed contains all rows after the first row up to the first blank row.
The first blank row terminates the data set. If expected data isn't appearing
in a feed, check the worksheet manually to see whether there's an unexpected
blank row in the middle of the data. In particular, if the second row of the
spreadsheet is blank, then the list feed will contain no data.</p>
<p>A row in a list feed is as many columns wide as the worksheet itself.</p>
<p class="alert-message info note"><strong>Note:</strong><span> The list feed supports both the <code>private</code> and <code>public</code> visibilities, and
both the <code>full</code> and <code>basic</code> projections.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To determine the URL of a list-based feed for a given worksheet, get the
    worksheets feed and examine the <code>content</code> element in which src is the list
    feed's URI.</p><p>To retrieve a list-based feed, send the following <code>GET</code> request, using the
list feed's URI and an appropriate authorization header:</p><pre class="prettyprint"><code><span class="pln">GET https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/list/key/worksheetId/private/full</span><span class="pln"><br></span></code></pre><p>The API returns a feed resembling the following:</p><pre class="prettyprint"><code><span class="tag">&lt;feed</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2005/Atom"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:openSearch</span><span class="pun">=</span><span class="atv">"http://a9.com/-/spec/opensearch/1.1/"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:gsx</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006/extended"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:gd</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/g/2005"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'W/"D0cERnk-eip7ImA9WBBXGEg."'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:23:45.173Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Sheet1</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml;type=feed"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">src</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"alternate"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/html"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/ccc?key=key"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/g/2005#feed"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/g/2005#post"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;author&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;name&gt;</span><span class="pln">Fitzwilliam Darcy</span><span class="tag">&lt;/name&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;email&gt;</span><span class="pln">fitz@gmail.com</span><span class="tag">&lt;/email&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/author&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;openSearch:totalResults&gt;</span><span class="pln">8</span><span class="tag">&lt;/openSearch:totalResults&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;openSearch:startIndex&gt;</span><span class="pln">1</span><span class="tag">&lt;/openSearch:startIndex&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;openSearch:itemsPerPage&gt;</span><span class="pln">8</span><span class="tag">&lt;/openSearch:itemsPerPage&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'"S0wCTlpIIip7ImA0X0QI"'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:23:45.173Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;category</span><span class="pln"> </span><span class="atn">scheme</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">term</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#list"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Bingley</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Hours: 10, Items: 2, IPM: 0.0033</span><span class="tag">&lt;/content&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId/version"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gsx:name&gt;</span><span class="pln">Bingley</span><span class="tag">&lt;/gsx:name&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gsx:hours&gt;</span><span class="pln">10</span><span class="tag">&lt;/gsx:hours&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gsx:items&gt;</span><span class="pln">2</span><span class="tag">&lt;/gsx:items&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gsx:ipm&gt;</span><span class="pln">0.0033</span><span class="tag">&lt;/gsx:ipm&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br><br>&nbsp; ...<br><br>&nbsp; </span><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'"AxQDSXxjfyp7ImA0ChJVSBI."'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:23:45.173Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;category</span><span class="pln"> </span><span class="atn">scheme</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">term</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#list"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Charlotte</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Hours: 60, Items: 18000, IPM: 5</span><span class="tag">&lt;/content&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId/version"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gsx:name&gt;</span><span class="pln">Charlotte</span><span class="tag">&lt;/gsx:name&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gsx:hours&gt;</span><span class="pln">60</span><span class="tag">&lt;/gsx:hours&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gsx:items&gt;</span><span class="pln">18000</span><span class="tag">&lt;/gsx:items&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gsx:ipm&gt;</span><span class="pln">5</span><span class="tag">&lt;/gsx:ipm&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br></span><span class="tag">&lt;/feed&gt;</span><span class="pln"><br></span></code></pre><p>Each entry represents a row in the worksheet. The <code>title</code> element contains
the contents of the first cell in the row, and the <code>content</code> element
contains a textual representation of the data from all the other cells in
the row.</p><p>Each item in the gsx namespace represents the contents of a cell in the
row, with elements in the <code>gsx</code> namespace named after the contents of the
header cells -- that is, the cells in the first row of the worksheet. If a
particular header cell is empty, then a unique column ID is used for the
gsx element name.  If the header cell's content contains a space or other
non-alphanumeric character, it will be removed in the <code>gsx</code> element name.</p></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code prints all rows of the first worksheet returned for the
    first spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> worksheetFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">(),</span><span class="pln"> </span><span class="typ">WorksheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> worksheetFeed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> worksheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Fetch the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; URL listFeedUrl </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="pln">getListFeedUrl</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ListFeed</span><span class="pln"> listFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">listFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ListFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Iterate through each row, printing its cell values.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ListEntry</span><span class="pln"> row </span><span class="pun">:</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the first column's cell value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">row</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Iterate over the remaining columns, and print each cell value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">String</span><span class="pln"> tag </span><span class="pun">:</span><span class="pln"> row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">getTags</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">getValue</span><span class="pun">(</span><span class="pln">tag</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code prints all rows of the first worksheet returned for the
    first spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pun">)</span><span class="pln">wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Define the URL to request the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">AtomLink</span><span class="pln"> listFeedLink </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="typ">Links</span><span class="pun">.</span><span class="typ">FindService</span><span class="pun">(</span><span class="typ">GDataSpreadsheetsNameTable</span><span class="pun">.</span><span class="typ">ListRel</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Fetch the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListQuery</span><span class="pln"> listQuery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListQuery</span><span class="pun">(</span><span class="pln">listFeedLink</span><span class="pun">.</span><span class="typ">HRef</span><span class="pun">.</span><span class="typ">ToString</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListFeed</span><span class="pln"> listFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">listQuery</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Iterate through each row, printing its cell values.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ListEntry</span><span class="pln"> row </span><span class="kwd">in</span><span class="pln"> listFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the first column's cell value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">row</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Iterate over the remaining columns, and print each cell value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ListEntry</span><span class="pun">.</span><span class="typ">Custom</span><span class="pln"> element </span><span class="kwd">in</span><span class="pln"> row</span><span class="pun">.</span><span class="typ">Elements</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">element</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<p class="alert-message special"><strong>Important:</strong><span> Rows are ordered in the same order in which they appear in the
worksheet user-interface, unless the query URL includes the <code>orderby</code> query
parameter.</span></p>
<h3 id="sorting_rows">Sorting rows</h3>
<p>By default, rows in the list feed appear in the same order as the corresponding
rows in the user-interface; that is, they're in order by row number.</p>
<p>To get rows in reverse order, send the following request, using the reverse
query parameter to specify the sort order.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><pre class="prettyprint"><code><span class="pln">GET https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/list/key/worksheetId/private/full?reverse=true</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><pre class="prettyprint"><code><span class="com">// Based on the sample above for getting rows in a worksheet</span><span class="pln"><br>URL listFeedUrl </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URI</span><span class="pun">(</span><span class="pln">worksheet</span><span class="pun">.</span><span class="pln">getListFeedUrl</span><span class="pun">().</span><span class="pln">toString</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"?reverse=true"</span><span class="pun">).</span><span class="pln">toURL</span><span class="pun">();</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><pre class="prettyprint"><code><span class="com">// Based on the sample above for getting rows in a worksheet</span><span class="pln"><br>listQuery</span><span class="pun">.</span><span class="typ">Reverse</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln"><br></span></code></pre></section></div>
<p>To sort the values in ascending order by a particular column, rather than by
row number, use the <code>orderby</code> query parameter.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><pre class="prettyprint"><code><span class="pln">GET https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/list/key/worksheetId/private/full?orderby=lastname</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><pre class="prettyprint"><code><span class="com">// Based on the sample above for getting rows in a worksheet</span><span class="pln"><br>URL listFeedUrl </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URI</span><span class="pun">(</span><span class="pln">worksheet</span><span class="pun">.</span><span class="pln">getListFeedUrl</span><span class="pun">().</span><span class="pln">toString</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"?orderby=lastname"</span><span class="pun">).</span><span class="pln">toURL</span><span class="pun">();</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><pre class="prettyprint"><code><span class="com">// Based on the sample above for getting rows in a worksheet</span><span class="pln"><br>listQuery</span><span class="pun">.</span><span class="typ">OrderByColumn</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"lastname"</span><span class="pun">;</span><span class="pln"><br></span></code></pre></section></div>
<p><code>reverse</code> and <code>orderby</code> can also be combined in order to sort by a column in
descending order.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><pre class="prettyprint"><code><span class="pln">GET https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/list/key/worksheetId/private/full?reverse=true&amp;orderby=lastname</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><pre class="prettyprint"><code><span class="com">// Based on the sample above for getting rows in a worksheet</span><span class="pln"><br>URL listFeedUrl </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URI</span><span class="pun">(</span><span class="pln">worksheet</span><span class="pun">.</span><span class="pln">getListFeedUrl</span><span class="pun">().</span><span class="pln">toString</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">+</span><span class="pln"> </span><span class="str">"?reverse=true&amp;orderby=lastname"</span><span class="pun">).</span><span class="pln">toURL</span><span class="pun">();</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><pre class="prettyprint"><code><span class="com">// Based on the sample above for getting rows in a worksheet</span><span class="pln"><br>listQuery</span><span class="pun">.</span><span class="typ">Reverse</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln"><br>listQuery</span><span class="pun">.</span><span class="typ">OrderByColumn</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"lastname"</span><span class="pun">;</span><span class="pln"><br></span></code></pre></section></div>
<h3 id="sending_a_structured_query_for_rows">Sending a structured query for rows</h3>
<p>Use the structured query parameter <code>sq</code> to produce a feed with entries that
meet the specified criteria. To find all people in a worksheet older than 25
years, with a height less than 175cm, one would use the query:</p>
<pre class="prettyprint"><code><span class="pln">age </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">25</span><span class="pln"> </span><span class="kwd">and</span><span class="pln"> height </span><span class="pun">&lt;</span><span class="pln"> </span><span class="lit">175</span><span class="pln"><br></span></code></pre>
<p>To run this query using the API directly, add it as the value of the <code>sq</code>
parameter.</p>
<p class="alert-message info note"><strong>Note:</strong><span> Always URL-encode query parameters.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><pre class="prettyprint"><code><span class="pln">GET https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/list/key/worksheetId/private/full?sq=age&gt;25%20and%20height&lt;175</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><pre class="prettyprint"><code><span class="com">// Based on the sample above for getting rows in a worksheet</span><span class="pln"><br>URL listFeedUrl </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URI</span><span class="pun">(</span><span class="pln">worksheet</span><span class="pun">.</span><span class="pln">getListFeedUrl</span><span class="pun">().</span><span class="pln">toString</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">+</span><span class="pln"> </span><span class="str">"?sq=age&gt;25%20and%20height&lt;175"</span><span class="pun">).</span><span class="pln">toURL</span><span class="pun">();</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The GData .NET client library takes care of URL-encoding the query
    parameters. .NET developers do not need to do anything to
    URL-encode them.</p><pre class="prettyprint"><code><span class="com">// Based on the sample above for getting rows in a worksheet</span><span class="pln"><br>listQuery</span><span class="pun">.</span><span class="typ">SpreadsheetQuery</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"age &gt; 25 and height &lt; 175"</span><span class="pun">;</span><span class="pln"><br></span></code></pre></section></div>
<p>The queries you can perform here are somewhat limited, because you cannot query
over columns that, for instance, begin with a digit. The names used here must
match their respective element names in lists feed results.</p>
<h3 id="adding_a_list_row">Adding a list row</h3>
<p>Adding rows to a worksheet via the list feed involves specifying values for each column in the worksheet, and sending this row representation to the API.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To add a row to a worksheet, start by creating an <code>entry</code> element
    containing the relevant data:</p><pre class="prettyprint"><code><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2005/Atom"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:gsx</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006/extended"</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gsx:hours&gt;</span><span class="pln">1</span><span class="tag">&lt;/gsx:hours&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gsx:ipm&gt;</span><span class="pln">1</span><span class="tag">&lt;/gsx:ipm&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gsx:items&gt;</span><span class="pln">60</span><span class="tag">&lt;/gsx:items&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gsx:name&gt;</span><span class="pln">Elizabeth Bennet</span><span class="tag">&lt;/gsx:name&gt;</span><span class="pln"><br></span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br></span></code></pre><p>Then determine the appropriate URL to send the entry to, known as the
<code>POST</code> URL.  You can find the <code>POST</code> URL in the list feed's <code>link</code> element
that has <code>rel="http://schemas.google.com/g/2005#post"</code>.</p><p>Next, do any necessary authentication, and create an <code>Authorization</code> header
for a new <code>POST</code> request as described in the authentication sections of
this document.</p><p>In the body of the <code>POST</code> request, place the Atom <code>entry</code> element you
created above, using the <code>application/atom+xml</code> content type.</p><p>Now, send the request to the <code>POST</code> URL:</p><pre class="prettyprint"><code><span class="pln">POST https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/list/key/worksheetId/private/full</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code inserts a new row into the first worksheet of the first
spreadsheet in the spreadsheets feed. The row has the data:</p><p><code>{firstname: 'Joe', lastname: 'Smith', age: 26, height: 176}</code></p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> worksheetFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">(),</span><span class="pln"> </span><span class="typ">WorksheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> worksheetFeed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> worksheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Fetch the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; URL listFeedUrl </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="pln">getListFeedUrl</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ListFeed</span><span class="pln"> listFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">listFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ListFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Create a local representation of the new row.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ListEntry</span><span class="pln"> row </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListEntry</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">setValueLocal</span><span class="pun">(</span><span class="str">"firstname"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Joe"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">setValueLocal</span><span class="pun">(</span><span class="str">"lastname"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Smith"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">setValueLocal</span><span class="pun">(</span><span class="str">"age"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"26"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">setValueLocal</span><span class="pun">(</span><span class="str">"height"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"176"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Send the new row to the API for insertion.</span><span class="pln"><br>&nbsp; &nbsp; row </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">insert</span><span class="pun">(</span><span class="pln">listFeedUrl</span><span class="pun">,</span><span class="pln"> row</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code inserts a new row into the first worksheet of the first
    spreadsheet in the spreadsheets feed. The row has the data:</p><p><code>{firstname: 'Joe', lastname: 'Smith', age: 26, height: 176}</code></p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pun">)</span><span class="pln">wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Define the URL to request the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">AtomLink</span><span class="pln"> listFeedLink </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="typ">Links</span><span class="pun">.</span><span class="typ">FindService</span><span class="pun">(</span><span class="typ">GDataSpreadsheetsNameTable</span><span class="pun">.</span><span class="typ">ListRel</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Fetch the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListQuery</span><span class="pln"> listQuery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListQuery</span><span class="pun">(</span><span class="pln">listFeedLink</span><span class="pun">.</span><span class="typ">HRef</span><span class="pun">.</span><span class="typ">ToString</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListFeed</span><span class="pln"> listFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">listQuery</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Create a local representation of the new row.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListEntry</span><span class="pln"> row </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListEntry</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; row</span><span class="pun">.</span><span class="typ">Elements</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListEntry</span><span class="pun">.</span><span class="typ">Custom</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">LocalName</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"firstname"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Joe"</span><span class="pln"> </span><span class="pun">});</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; row</span><span class="pun">.</span><span class="typ">Elements</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListEntry</span><span class="pun">.</span><span class="typ">Custom</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">LocalName</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"lastname"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Smith"</span><span class="pln"> </span><span class="pun">});</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; row</span><span class="pun">.</span><span class="typ">Elements</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListEntry</span><span class="pun">.</span><span class="typ">Custom</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">LocalName</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"age"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"26"</span><span class="pln"> </span><span class="pun">});</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; row</span><span class="pun">.</span><span class="typ">Elements</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListEntry</span><span class="pun">.</span><span class="typ">Custom</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"> </span><span class="typ">LocalName</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"height"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"176"</span><span class="pln"> </span><span class="pun">});</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Send the new row to the API for insertion.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; service</span><span class="pun">.</span><span class="typ">Insert</span><span class="pun">(</span><span class="pln">listFeed</span><span class="pun">,</span><span class="pln"> row</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<p>The API inserts the new row immediately after the last row that appears in the
list feed, which is to say immediately before the first entirely blank row.</p>
<h3 id="updating_a_list_row">Updating a list row</h3>
<p>The Spreadsheets API allows rows to be manipulated in place.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To update the contents of an existing row, first retrieve the row to
update, modify it as desired, and then send a <code>PUT</code> request, with the
updated row in the message body, to the row's <code>edit</code> URL.</p><p>Be sure that the <code>id</code> value in the entry you PUT exactly matches the <code>id</code>
of the existing entry. The <code>edit</code> URL is highlighted in the following row
entry:</p><pre class="prettyprint"><code><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'"S0wCTlpIIip7ImA0X0QI"'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:23:45.173Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;category</span><span class="pln"> </span><span class="atn">scheme</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">term</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#list"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Bingley</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Hours: 10, Items: 2, IPM: 0.0033</span><span class="tag">&lt;/content&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId/version"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gsx:name&gt;</span><span class="pln">Bingley</span><span class="tag">&lt;/gsx:name&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gsx:hours&gt;</span><span class="pln">20</span><span class="tag">&lt;/gsx:hours&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gsx:items&gt;</span><span class="pln">4</span><span class="tag">&lt;/gsx:items&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gsx:ipm&gt;</span><span class="pln">0.0033</span><span class="tag">&lt;/gsx:ipm&gt;</span><span class="pln"><br></span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code snippet updates the first row of the first worksheet of
the first spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> worksheetFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">(),</span><span class="pln"> </span><span class="typ">WorksheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> worksheetFeed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> worksheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Fetch the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; URL listFeedUrl </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="pln">getListFeedUrl</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ListFeed</span><span class="pln"> listFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">listFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ListFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a row more intelligently based on your app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ListEntry</span><span class="pln"> row </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Update the row's data.</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">setValueLocal</span><span class="pun">(</span><span class="str">"firstname"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Sarah"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">setValueLocal</span><span class="pun">(</span><span class="str">"lastname"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Hunt"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">setValueLocal</span><span class="pun">(</span><span class="str">"age"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"32"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="pln">getCustomElements</span><span class="pun">().</span><span class="pln">setValueLocal</span><span class="pun">(</span><span class="str">"height"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"154"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Save the row using the API.</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="pln">update</span><span class="pun">();</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code snippet updates the first row of the first worksheet of
    the first spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pun">)</span><span class="pln">wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Define the URL to request the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">AtomLink</span><span class="pln"> listFeedLink </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="typ">Links</span><span class="pun">.</span><span class="typ">FindService</span><span class="pun">(</span><span class="typ">GDataSpreadsheetsNameTable</span><span class="pun">.</span><span class="typ">ListRel</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Fetch the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListQuery</span><span class="pln"> listQuery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListQuery</span><span class="pun">(</span><span class="pln">listFeedLink</span><span class="pun">.</span><span class="typ">HRef</span><span class="pun">.</span><span class="typ">ToString</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListFeed</span><span class="pln"> listFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">listQuery</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a row more intelligently based on your app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListEntry</span><span class="pln"> row </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ListEntry</span><span class="pun">)</span><span class="pln">listFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Update the row's data.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ListEntry</span><span class="pun">.</span><span class="typ">Custom</span><span class="pln"> element </span><span class="kwd">in</span><span class="pln"> row</span><span class="pun">.</span><span class="typ">Elements</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">element</span><span class="pun">.</span><span class="typ">LocalName</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"firstname"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; element</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Sarah"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">element</span><span class="pun">.</span><span class="typ">LocalName</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"lastname"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; element</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"Hunt"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">element</span><span class="pun">.</span><span class="typ">LocalName</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"age"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; element</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"32"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">element</span><span class="pun">.</span><span class="typ">LocalName</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"height"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; element</span><span class="pun">.</span><span class="typ">Value</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"154"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Save the row using the API.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; row</span><span class="pun">.</span><span class="typ">Update</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h3 id="deleting_a_list_row">Deleting a list row</h3>
<p>The Spreadsheets API supports deleting rows in place.  When a row is deleted,
all rows beneath that row are pushed up by one.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To delete a row, first retrieve the row to delete, then send a <code>DELETE</code>
    request to the row's <code>edit</code> URL. This is the same URL used to update the
    row.</p><pre class="prettyprint"><code><span class="pln">DELETE https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/list/key/worksheetId/private/full/rowId/rowVersion</span><span class="pln"><br></span></code></pre><p>If you want to make sure that you don't delete a row that has been changed
by another client since you retrieved it, include an HTTP <code>If-Match</code> header
that contains the original row's ETag value. You can determine the original
row's ETag value by examining the <code>entry</code> element's <code>gd:etag</code> attribute.</p><p>If you want to delete the row regardless of whether someone else has
updated it since you retrieved it, then use If-Match: * and don't include
the ETag. (In this case, you don't need to retrieve the row before deleting
it.)</p></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> worksheetFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">(),</span><span class="pln"> </span><span class="typ">WorksheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> worksheetFeed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> worksheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Fetch the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; URL listFeedUrl </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="pln">getListFeedUrl</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ListFeed</span><span class="pln"> listFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">listFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ListFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a row more intelligently based on your app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">ListEntry</span><span class="pln"> row </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Delete the row using the API.</span><span class="pln"><br>&nbsp; &nbsp; row</span><span class="pun">.</span><span class="kwd">delete</span><span class="pun">();</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pun">)</span><span class="pln">wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Define the URL to request the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">AtomLink</span><span class="pln"> listFeedLink </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="typ">Links</span><span class="pun">.</span><span class="typ">FindService</span><span class="pun">(</span><span class="typ">GDataSpreadsheetsNameTable</span><span class="pun">.</span><span class="typ">ListRel</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Fetch the list feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListQuery</span><span class="pln"> listQuery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ListQuery</span><span class="pun">(</span><span class="pln">listFeedLink</span><span class="pun">.</span><span class="typ">HRef</span><span class="pun">.</span><span class="typ">ToString</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListFeed</span><span class="pln"> listFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">listQuery</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a row more intelligently based on your app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">ListEntry</span><span class="pln"> row </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">ListEntry</span><span class="pun">)</span><span class="pln">listFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Delete the row using the API.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; row</span><span class="pun">.</span><span class="typ">Delete</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h2 id="working_with_cell-based_feeds">Working with cell-based feeds</h2>
<p>In a cell feed, each entry represents a single cell.  Cells are referred to by
position.</p>
<p>There are two positioning notations used in Google Spreadsheets.  The first,
called <code>A1</code> notation, uses characters from the Latin alphabet to indicate the
column, and integers to indicate the row of a cell.  The second, called <code>R1C1</code>
notation, uses integers to represent both the column and the row, and precedes
each by a corresponding <code>R</code> or <code>C</code>, to indicate row or column number.  The
addresses <code>A1</code> and <code>R1C1</code> are equivalent, as are the addresses <code>B5</code> and <code>R5C2</code>.</p>
<p>Cell ranges also have notations in Google Spreadsheets, but those are less relevant here.</p>
<p>Formulas often refer to other cells or cell ranges by their position.  The
cells feed allows formulas to be set on cells.  However, the API always returns
cell addresses for formulas on cells in <code>R1C1</code> notation, even if the formula
was set with <code>A1</code> notation.</p>
<p>The title of a cell entry is always the <code>A1</code> position of the cell.</p>
<p>The <code>id</code> URI of a cell entry always contains the <code>R1C1</code> position of the cell.</p>
<p>The <code>inputValue</code> attribute of a cell entry always contains the value that a
user would otherwise type into the Google Spreadsheets user interface to
manipulate the cell (i.e. either a literal value or a formula).  To set a
formula or a literal value on a cell, provide the text of the formula or value
as the <code>inputValue</code> attribute. Remember that formulas must start with <code>=</code> to be
considered a formula.  If a cell contains a formula, the formula is always
provided as the <code>inputValue</code> when cell entries are returned by the API.</p>
<p>The <code>numericValue</code> attribute of a cell entry, when present, indicates that the
cell was determined to have a numeric value, and its numeric value is indicated
with this attributed.</p>
<p>The literal value of the cell element is the calculated value of the cell,
without formatting applied.  If the cell contains a formula, the calculated
value is given here.  The Spreadsheets API has no concept of formatting, and
thus cannot manipulate formatting of cells.</p>
<h3 id="retrieving_a_cell-based_feed">Retrieving a cell-based feed</h3>
<p class="alert-message info note"><strong>Note:</strong><span> The cells feed supports both the <code>private</code> and <code>public</code> visibilities, and
both the <code>full</code> and <code>basic</code> projections.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To determine the URL of a cell feed for a given worksheet, get the
    worksheets feed and examine the <code>link</code> element in which <code>rel</code> is
    <code>http://schemas.google.com/spreadsheets/2006#cellsfeed</code>. The <code>href</code> value
    in that element is the cell feed's URI.</p><p>To retrieve a cell-based feed, send the following <code>GET</code> request, using the
cell feed's URI and an appropriate authorization header:</p><pre class="prettyprint"><code><span class="pln">GET https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/cells/key/worksheetId/private/full</span><span class="pln"><br></span></code></pre><p>The API returns a feed resembling the following:</p><pre class="prettyprint"><code><span class="tag">&lt;feed</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2005/Atom"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:openSearch</span><span class="pun">=</span><span class="atv">"http://a9.com/-/spec/opensearch/1.1/"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:gs</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:gd</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/g/2005"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'W/"D0cERnk-eip7ImA9WBBXGEg."'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:27:32.543Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Sheet1</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"alternate"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text/html"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/ccc?key=key"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/g/2005#feed"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &lt;link rel="http://schemas.google.com/g/2005#post" type="application/atom+xml"<br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/g/2005#batch"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/batch"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; href="https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full"/&gt;<br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;author&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;name&gt;</span><span class="pln">Fitzwilliam Darcy</span><span class="tag">&lt;/name&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;email&gt;</span><span class="pln">fitz@gmail.com</span><span class="tag">&lt;/email&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/author&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;openSearch:startIndex&gt;</span><span class="pln">1</span><span class="tag">&lt;/openSearch:startIndex&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;openSearch:itemsPerPage&gt;</span><span class="pln">36</span><span class="tag">&lt;/openSearch:itemsPerPage&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gs:rowCount&gt;</span><span class="pln">100</span><span class="tag">&lt;/gs:rowCount&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gs:colCount&gt;</span><span class="pln">20</span><span class="tag">&lt;/gs:colCount&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'"ImA9D1APFyp7"'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R1C1</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:27:32.543Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;category</span><span class="pln"> </span><span class="atn">scheme</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">term</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#cell"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">A1</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Name</span><span class="tag">&lt;/content&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R1C1"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R1C1/bgvjf"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gs:cell</span><span class="pln"> </span><span class="atn">row</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">col</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">inputValue</span><span class="pun">=</span><span class="atv">"Name"</span><span class="tag">&gt;</span><span class="pln">Name</span><span class="tag">&lt;/gs:cell&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'"YD0PS1YXByp7Ig.."'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R1C2</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:27:32.543Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;category</span><span class="pln"> </span><span class="atn">scheme</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">term</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#cell"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">B1</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">Hours</span><span class="tag">&lt;/content&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R1C2"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R1C2/1pn567"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gs:cell</span><span class="pln"> </span><span class="atn">row</span><span class="pun">=</span><span class="atv">"1"</span><span class="pln"> </span><span class="atn">col</span><span class="pun">=</span><span class="atv">"2"</span><span class="pln"> </span><span class="atn">inputValue</span><span class="pun">=</span><span class="atv">"Hours"</span><span class="tag">&gt;</span><span class="pln">Hours</span><span class="tag">&lt;/gs:cell&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br><br>&nbsp; ...<br><br>&nbsp; </span><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">gd:etag</span><span class="pun">=</span><span class="atv">'"ImB5CBYSRCp7"'</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R9C4</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;updated&gt;</span><span class="pln">2006-11-17T18:27:32.543Z</span><span class="tag">&lt;/updated&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;category</span><span class="pln"> </span><span class="atn">scheme</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">term</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006#cell"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">D9</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;content</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">5</span><span class="tag">&lt;/content&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"self"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R9C4"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R9C4/srevc"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gs:cell</span><span class="pln"> </span><span class="atn">row</span><span class="pun">=</span><span class="atv">"9"</span><span class="pln"> </span><span class="atn">col</span><span class="pun">=</span><span class="atv">"4"</span><span class="pln"> </span><span class="atn">inputValue</span><span class="pun">=</span><span class="atv">"=FLOOR(R[0]C[-1]/(R[0]C[-2]*60),.0001)"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">numericValue</span><span class="pun">=</span><span class="atv">"5.0"</span><span class="tag">&gt;</span><span class="pln">5</span><span class="tag">&lt;/gs:cell&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br></span><span class="tag">&lt;/feed&gt;</span><span class="pln"><br></span></code></pre></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code prints all of the cells in the first worksheet of the
    first spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> worksheetFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">(),</span><span class="pln"> </span><span class="typ">WorksheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> worksheetFeed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> worksheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Fetch the cell feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; URL cellFeedUrl </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="pln">getCellFeedUrl</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> cellFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">cellFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Iterate through each cell, printing its value.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> cell </span><span class="pun">:</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's address in A1 notation</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's address in R1C1 notation</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getId</span><span class="pun">().</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getId</span><span class="pun">().</span><span class="pln">lastIndexOf</span><span class="pun">(</span><span class="str">'/'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's formula or text value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getCell</span><span class="pun">().</span><span class="pln">getInputValue</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's calculated value if the cell's value is numeric</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Prints empty string if cell's value is not numeric</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getCell</span><span class="pun">().</span><span class="pln">getNumericValue</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's displayed value (useful if the cell has a formula)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getCell</span><span class="pun">().</span><span class="pln">getValue</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code prints all of the cells in the first worksheet of the
    first spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pun">)</span><span class="pln">wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Fetch the cell feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellQuery</span><span class="pln"> cellQuery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellQuery</span><span class="pun">(</span><span class="pln">worksheet</span><span class="pun">.</span><span class="typ">CellFeedLink</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> cellFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">cellQuery</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Iterate through each cell, printing its value.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> cell </span><span class="kwd">in</span><span class="pln"> cellFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's address in A1 notation</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's address in R1C1 notation</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Id</span><span class="pun">.</span><span class="typ">Uri</span><span class="pun">.</span><span class="typ">Content</span><span class="pun">.</span><span class="typ">Substring</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Id</span><span class="pun">.</span><span class="typ">Uri</span><span class="pun">.</span><span class="typ">Content</span><span class="pun">.</span><span class="typ">LastIndexOf</span><span class="pun">(</span><span class="str">"/"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's formula or text value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">InputValue</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's calculated value if the cell's value is numeric</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Prints empty string if cell's value is not numeric</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">NumericValue</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's displayed value (useful if the cell has a formula)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h3 id="fetching_specific_rows_or_columns">Fetching specific rows or columns</h3>
<p>The Spreadsheets API allows users to fetch specific rows or columns from a
worksheet by providing additional URL parameters when making a request.</p>
<p class="alert-message warning"><strong>Warning:</strong><span> Column numbers used in these queries are not permanent.  The result of
the query will change if rows or columns are added or removed.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>To query for every row after the first row, and only the fourth column,
    send the request:</p><pre class="prettyprint"><code><span class="pln">GET https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/cells/key/worksheetId/private/full?min-row=2&amp;min-col=4&amp;max-col=4</span><span class="pln"><br></span></code></pre><p>The response includes all cells in column 4, starting with row 2.</p></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code prints all of the cells in every row after the first
    row, and only the fourth column, of the first worksheet of the first
    spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> worksheetFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">(),</span><span class="pln"> </span><span class="typ">WorksheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> worksheetFeed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> worksheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Fetch column 4, and every row after row 1.</span><span class="pln"><br>&nbsp; &nbsp; URL cellFeedUrl </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URI</span><span class="pun">(</span><span class="pln">worksheet</span><span class="pun">.</span><span class="pln">getCellFeedUrl</span><span class="pun">().</span><span class="pln">toString</span><span class="pun">()</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">+</span><span class="pln"> </span><span class="str">"?min-row=2&amp;min-col=4&amp;max-col=4"</span><span class="pun">).</span><span class="pln">toURL</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> cellFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">cellFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Iterate through each cell, printing its value.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> cell </span><span class="pun">:</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's address in A1 notation</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's address in R1C1 notation</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getId</span><span class="pun">().</span><span class="pln">substring</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getId</span><span class="pun">().</span><span class="pln">lastIndexOf</span><span class="pun">(</span><span class="str">'/'</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's formula or text value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getCell</span><span class="pun">().</span><span class="pln">getInputValue</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's calculated value if the cell's value is numeric</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Prints empty string if cell's value is not numeric</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getCell</span><span class="pun">().</span><span class="pln">getNumericValue</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's displayed value (useful if the cell has a formula)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getCell</span><span class="pun">().</span><span class="pln">getValue</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"\t"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following code prints all of the cells in every row after the first
    row, and only the fourth column, of the first worksheet of the first
    spreadsheet in the spreadsheets feed.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pun">)</span><span class="pln">wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Fetch the cell feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellQuery</span><span class="pln"> cellQuery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellQuery</span><span class="pun">(</span><span class="pln">worksheet</span><span class="pun">.</span><span class="typ">CellFeedLink</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; cellQuery</span><span class="pun">.</span><span class="typ">MinimumRow</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">2</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; cellQuery</span><span class="pun">.</span><span class="typ">MinimumColumn</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; cellQuery</span><span class="pun">.</span><span class="typ">MaximumColumn</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> cellFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">cellQuery</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Iterate through each cell, printing its value.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> cell </span><span class="kwd">in</span><span class="pln"> cellFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's address in A1 notation</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's address in R1C1 notation</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Id</span><span class="pun">.</span><span class="typ">Uri</span><span class="pun">.</span><span class="typ">Content</span><span class="pun">.</span><span class="typ">Substring</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Id</span><span class="pun">.</span><span class="typ">Uri</span><span class="pun">.</span><span class="typ">Content</span><span class="pun">.</span><span class="typ">LastIndexOf</span><span class="pun">(</span><span class="str">"/"</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's formula or text value</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">InputValue</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's calculated value if the cell's value is numeric</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Prints empty string if cell's value is not numeric</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">NumericValue</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// Print the cell's displayed value (useful if the cell has a formula)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Value</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>
<h3 id="changing_contents_of_a_cell">Changing contents of a cell</h3>
<p>Cells can be modified in place.  Unlike other feeds, cells are not directly
added nor deleted.  They are fixed in place, based on the dimensions of a given
worksheet.  To add or remove cells from a worksheet, use the worksheets feed to
change the dimension of the worksheet.  To empty a cell, simply update its
value to be an empty string.</p>
<p class="alert-message special"><strong>Important:</strong><span> The cells feed allows for setting a formula on a cell by starting
the cell <code>inputValue</code> with an <code>=</code> character.  The calculated value of the cell
is provided as the cell's actual value.</span></p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>Note: Use HTTP <code>PUT</code> to change the data in a cell, even if it is empty; the
    use of <code>POST</code> on empty cells is no longer recommended. To clear a cell,
    send an entry with an empty content element in your <code>PUT</code> request instead
    of using <code>DELETE</code>.</p><p>To modify a cell in a worksheet, start by creating an <code>entry</code> element
containing the relevant data, which in this case is a formula:</p><pre class="prettyprint"><code><span class="tag">&lt;entry</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2005/Atom"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">xmlns:gs</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R2C4</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R2C4"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;gs:cell</span><span class="pln"> </span><span class="atn">row</span><span class="pun">=</span><span class="atv">"2"</span><span class="pln"> </span><span class="atn">col</span><span class="pun">=</span><span class="atv">"4"</span><span class="pln"> </span><span class="atn">inputValue</span><span class="pun">=</span><span class="atv">"=SUM(A1:B6)"</span><span class="tag">/&gt;</span><span class="pln"><br></span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br></span></code></pre><p>Find the <code>edit</code> URL for the desired cell by performing a <code>GET</code> request to
first find the cell. The edit URL is in the href attribute of a <code>link</code>
element which has a <code>rel</code> attribute set to <code>edit</code>.</p><p>In the body of the <code>PUT</code> request, place the <code>entry</code> element you created
above, using the <code>application/atom+xml</code> content type.</p><p>Now, send the <code>PUT</code> request to the appropriate Spreadsheets <code>edit</code> URL
retrieved above, (replacing key, worksheetId, and cell with their
appropriate values):</p><pre class="prettyprint"><code><span class="pln">PUT https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/cell</span><span class="pln"><br></span></code></pre><p>The new data is placed in the specified cell in the worksheet. If the
specified cell contains data already, it is replaced.</p></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following code updates the value of cell <code>A1</code> to be <code>200</code>.  It then
    updates the formula of cell <code>B1</code> to be <code>=SUM(A1, 200)</code>.</p><p class="alert-message special"><strong>Important:</strong><span> The method <code>CellEntry.changeInputValueLocal()</code> must be used to
set the literal value of a cell or the formula of a cell.  The intended
behavior is determined exactly as it is in the Google Spreadsheets user
interface.  If the value given begins with an <code>=</code> character, a formula will
be set.</span></p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.*;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.*;</span><span class="pln"><br><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Define the URL to request. &nbsp;This should never change.</span><span class="pln"><br>&nbsp; &nbsp; URL SPREADSHEET_FEED_URL </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="str">"https://spreadsheets.google.com/feeds/spreadsheets/private/full"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">SPREADSHEET_FEED_URL</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">SpreadsheetEntry</span><span class="pun">&gt;</span><span class="pln"> spreadsheets </span><span class="pun">=</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">spreadsheets</span><span class="pun">.</span><span class="pln">size</span><span class="pun">()</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> spreadsheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">());</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> worksheetFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; spreadsheet</span><span class="pun">.</span><span class="pln">getWorksheetFeedUrl</span><span class="pun">(),</span><span class="pln"> </span><span class="typ">WorksheetFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">WorksheetEntry</span><span class="pun">&gt;</span><span class="pln"> worksheets </span><span class="pun">=</span><span class="pln"> worksheetFeed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> worksheets</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="lit">0</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Fetch the cell feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; URL cellFeedUrl </span><span class="pun">=</span><span class="pln"> worksheet</span><span class="pun">.</span><span class="pln">getCellFeedUrl</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> cellFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">cellFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Iterate through each cell, updating its value if necessary.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// TODO: Update cell values more intelligently.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> cell </span><span class="pun">:</span><span class="pln"> feed</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">().</span><span class="pln">equals</span><span class="pun">(</span><span class="str">"A1"</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; cell</span><span class="pun">.</span><span class="pln">changeInputValueLocal</span><span class="pun">(</span><span class="str">"200"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; cell</span><span class="pun">.</span><span class="pln">update</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"> </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="pln">getTitle</span><span class="pun">().</span><span class="pln">getPlainText</span><span class="pun">().</span><span class="pln">equals</span><span class="pun">(</span><span class="str">"B1"</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; cell</span><span class="pun">.</span><span class="pln">changeInputValueLocal</span><span class="pun">(</span><span class="str">"=SUM(A1, 200)"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; cell</span><span class="pun">.</span><span class="pln">update</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre><p>Once updated, cell A1 has the value <code>200</code>.  Cell B1 shows the value <code>400</code>,
but has a numeric value of <code>400.0</code> and an <code>inputValue</code> of <code>=SUM(R1C1,
200)</code>.</p></section><section><h3 style="display: none; ">.NET</h3><p>The following code updates the value of cell <code>A1</code> to be <code>200</code>.  It then
    updates the formula of cell <code>B1</code> to be <code>=SUM(A1, 200)</code>.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Program</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Authorize the service object for a specific user (see other sections)</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Instantiate a SpreadsheetQuery object to retrieve spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetQuery</span><span class="pln"> query </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetQuery</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Make a request to the API and get all spreadsheets.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetFeed</span><span class="pln"> feed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Count</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: There were no spreadsheets, act accordingly.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a spreadsheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetEntry</span><span class="pln"> spreadsheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">SpreadsheetEntry</span><span class="pun">)</span><span class="pln">feed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Get the first worksheet of the first spreadsheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// TODO: Choose a worksheet more intelligently based on your</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// app's needs.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetFeed</span><span class="pln"> wsFeed </span><span class="pun">=</span><span class="pln"> spreadsheet</span><span class="pun">.</span><span class="typ">Worksheets</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">WorksheetEntry</span><span class="pln"> worksheet </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">WorksheetEntry</span><span class="pun">)</span><span class="pln">wsFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Fetch the cell feed of the worksheet.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellQuery</span><span class="pln"> cellQuery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellQuery</span><span class="pun">(</span><span class="pln">worksheet</span><span class="pun">.</span><span class="typ">CellFeedLink</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> cellFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">cellQuery</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Iterate through each cell, updating its value if necessary.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> cell </span><span class="kwd">in</span><span class="pln"> cellFeed</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"A1"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cell</span><span class="pun">.</span><span class="typ">InputValue</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"200"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cell</span><span class="pun">.</span><span class="typ">Update</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">cell</span><span class="pun">.</span><span class="typ">Title</span><span class="pun">.</span><span class="typ">Text</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> </span><span class="str">"B1"</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cell</span><span class="pun">.</span><span class="typ">InputValue</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="str">"=SUM(A1, 200)"</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cell</span><span class="pun">.</span><span class="typ">Update</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre><p>Once updated, cell A1 has the value <code>200</code>.  Cell B1 shows the value <code>400</code>,
but has a numeric value of <code>400.0</code> and an <code>inputValue</code> of <code>=SUM(R1C1,
200)</code>.</p></section></div>
<p class="alert-message info note"><strong>Note:</strong><span> Even though formula values may be set using A1 notation, the API always
returns cell addresses in formulas in R1C1 notation.</span></p>
<h3 id="updating_multiple_cells_with_a_batch_request">Updating multiple cells with a batch request</h3>
<p>The API supports updating an entire column, row, or other set of cells, in a
single request.  This is offered to improve performance over making large sets
of individual requests.  This process is called "batching requests".</p>
<p class="alert-message special"><strong>Important:</strong><span> Only the cells feed supports batching requests.</span></p>
<p>A number of batch operations can be combined into a single request.  The two
types of batch operations supported are <code>query</code> and <code>update</code>.  <code>insert</code> and
<code>delete</code> are not supported because the cells feed cannot be used to insert or
delete cells.  Remember that the worksheets feed must be used to do that.</p>
<p><code>query</code> and <code>update</code> can be combined in any size set, and sent to the API in a
single request.  The API responds with information on the status of each
individual operation within the batch.  For <code>query</code> requests, the result is the
requested cell.  For <code>update</code> requests, the result includes the manipulated
cell with new values.</p>
<div class="ds-selector-tabs ds-selector ui-datasection-main" data-ds-scope="code-sample"><div class="selector"><div class="kd-buttonbar kd-tabbar-horz"><a value="protocol" class="kd-tabbutton">Protocol</a><a value="java" class="kd-tabbutton">Java</a><a value=".net" class="kd-tabbutton selected">.NET</a></div></div><section class="ui-datasection-hide"><h3 style="display: none; ">Protocol</h3><p>Begin by creating a cells feed and setting the feed <code>id</code> to the href value
    of the <code>POST</code> link, appending <code>/batch</code>. A sample URL may look like:</p><pre class="prettyprint"><code><span class="pln">https</span><span class="pun">:</span><span class="com">//spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/batch</span><span class="pln"><br></span></code></pre><p>Then, append all the entries to be updated to the feed as per the XML shown
below and set the <code>batch:operation</code> to <code>update</code>. Finally, post the feed to
the cells feed <code>edit</code> link.</p><pre class="prettyprint"><code><span class="tag">&lt;feed</span><span class="pln"> </span><span class="atn">xmlns</span><span class="pun">=</span><span class="atv">"http://www.w3.org/2005/Atom"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">xmlns:batch</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/gdata/batch"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">xmlns:gs</span><span class="pun">=</span><span class="atv">"http://schemas.google.com/spreadsheets/2006"</span><span class="tag">&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;entry&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;batch:id&gt;</span><span class="pln">A1</span><span class="tag">&lt;/batch:id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;batch:operation</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"update"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R2C4</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R2C4/version"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gs:cell</span><span class="pln"> </span><span class="atn">row</span><span class="pun">=</span><span class="atv">"2"</span><span class="pln"> </span><span class="atn">col</span><span class="pun">=</span><span class="atv">"4"</span><span class="pln"> </span><span class="atn">inputValue</span><span class="pun">=</span><span class="atv">"newData"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br>&nbsp; ...<br>&nbsp; </span><span class="tag">&lt;entry&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;batch:id&gt;</span><span class="pln">A2</span><span class="tag">&lt;/batch:id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;batch:operation</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"update"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;title</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"text"</span><span class="tag">&gt;</span><span class="pln">A2</span><span class="tag">&lt;/title&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;id&gt;</span><span class="pln">https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R2C5</span><span class="tag">&lt;/id&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;link</span><span class="pln"> </span><span class="atn">rel</span><span class="pun">=</span><span class="atv">"edit"</span><span class="pln"> </span><span class="atn">type</span><span class="pun">=</span><span class="atv">"application/atom+xml"</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="atn">href</span><span class="pun">=</span><span class="atv">"https://spreadsheets.google.com/feeds/cells/key/worksheetId/private/full/R2C5/version"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="tag">&lt;gs:cell</span><span class="pln"> </span><span class="atn">row</span><span class="pun">=</span><span class="atv">"2"</span><span class="pln"> </span><span class="atn">col</span><span class="pun">=</span><span class="atv">"5"</span><span class="pln"> </span><span class="atn">inputValue</span><span class="pun">=</span><span class="atv">"moreInfo"</span><span class="tag">/&gt;</span><span class="pln"><br>&nbsp; </span><span class="tag">&lt;/entry&gt;</span><span class="pln"><br></span><span class="tag">&lt;/feed&gt;</span><span class="pln"><br></span></code></pre><p>Each cell entry element appended to the feed element must contain the
following elements:</p><dl><dt>batch:id</dt><dd>A <code>batch:id</code> element, uniquely identifying each individual cell update within the batch update request. For best results, set this value to some local identifier, so that the response can be identified once retrieved.</dd><dt>batch:operation</dt><dd>A <code>batch:operation</code> element, whose <code>type</code> attribute determines the type of request to be performed (<code>query</code> or <code>update</code>).</dd><dt>id</dt><dd>An <code>id</code> element containing the full URL to the cell to be updated. Be sure to examine the output XML when requesting the cells feed for more details.</dd><dt>link</dt><dd>A <code>link</code> element whose <code>rel</code> attribute is set to <code>edit</code>. The link's <code>type</code> attribute must be set to <code>application/atom+xml</code> and the <code>href</code> attribute must contain the full path to the cell's id (as in the 'id' element discussed above), in the following format: https://google.com/feeds/cells/key/worksheetId/private/full/R1C1CellIdentifier. Refer to the contents of the cells feed for more details.</dd><dt>gs:cell</dt><dd>A <code>gs:cell</code> element, whose <code>row</code> attribute corresponds to the row being updated, whose <code>col</code> attribute corresponds to the column being updated and whose <code>inputValue</code> attribute contains the same information as the value of the content element discussed above, or the new formula for the cell.</dd></dl><p class="alert-message info note"><strong>Note:</strong><span> Only HTTP <code>GET</code> and <code>PUT</code> operations are supported for cells feed
batch processing. Each element in the batch request should contain
<code>batch:operation type="query"</code> and <code>batch:operation type="update"</code>
respectively.</span></p></section><section class="ui-datasection-hide"><h3 style="display: none; ">Java</h3><p>The following is a complete program for updating large numbers of cells.
    It uses ClientLogin for authentication and authorization.</p><pre class="prettyprint"><code><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">sample</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">SimpleCommandLineParser</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">FeedURLFactory</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">client</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">SpreadsheetService</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="typ">Link</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">.</span><span class="typ">BatchOperationType</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">.</span><span class="typ">BatchStatus</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">.</span><span class="typ">BatchUtils</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">CellEntry</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">data</span><span class="pun">.</span><span class="pln">spreadsheet</span><span class="pun">.</span><span class="typ">CellFeed</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">AuthenticationException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">google</span><span class="pun">.</span><span class="pln">gdata</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">ServiceException</span><span class="pun">;</span><span class="pln"><br><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">io</span><span class="pun">.</span><span class="typ">IOException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.</span><span class="typ">MalformedURLException</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">net</span><span class="pun">.</span><span class="pln">URL</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">ArrayList</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">HashMap</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">List</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> java</span><span class="pun">.</span><span class="pln">util</span><span class="pun">.</span><span class="typ">Map</span><span class="pun">;</span><span class="pln"><br><br></span><span class="com">/**<br>&nbsp;* A sample application showing how to efficiently use batch updates with the<br>&nbsp;* Spreadsheets API to create new cells.<br>&nbsp;*<br>&nbsp;* The specified spreadsheet key will be filled in with 'RnCn' identifier of<br>&nbsp;* each cell, up to the {@code MAX_ROWS} and {@code MAX_COLS} constants defined<br>&nbsp;* in this class.<br>&nbsp;*<br>&nbsp;* Usage: java BatchCellUpdater --username [user] --password [pass] --key [spreadsheet-key]<br>&nbsp;*<br>&nbsp;* @author Josh Danziger<br>&nbsp;*/</span><span class="pln"><br></span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">BatchCellUpdater</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; </span><span class="com">/** The number of rows to fill in the destination workbook */</span><span class="pln"><br>&nbsp; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAX_ROWS </span><span class="pun">=</span><span class="pln"> </span><span class="lit">75</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; </span><span class="com">/** The number of columns to fill in the destination workbook */</span><span class="pln"><br>&nbsp; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAX_COLS </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; </span><span class="com">/**<br>&nbsp; &nbsp;* A basic struct to store cell row/column information and the associated RnCn<br>&nbsp; &nbsp;* identifier.<br>&nbsp; &nbsp;*/</span><span class="pln"><br>&nbsp; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">CellAddress</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> row</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> col</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">final</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> idString</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">/**<br>&nbsp; &nbsp; &nbsp;* Constructs a CellAddress representing the specified {@code row} and<br>&nbsp; &nbsp; &nbsp;* {@code col}. &nbsp;The idString will be set in 'RnCn' notation.<br>&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">CellAddress</span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> row</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> col</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">row </span><span class="pun">=</span><span class="pln"> row</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">col </span><span class="pun">=</span><span class="pln"> col</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">idString </span><span class="pun">=</span><span class="pln"> </span><span class="typ">String</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="str">"R%sC%s"</span><span class="pun">,</span><span class="pln"> row</span><span class="pun">,</span><span class="pln"> col</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">(</span><span class="typ">String</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">AuthenticationException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">MalformedURLException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Command line parsing</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SimpleCommandLineParser</span><span class="pln"> parser </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SimpleCommandLineParser</span><span class="pun">(</span><span class="pln">args</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> username </span><span class="pun">=</span><span class="pln"> parser</span><span class="pun">.</span><span class="pln">getValue</span><span class="pun">(</span><span class="str">"username"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"user"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"u"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> password </span><span class="pun">=</span><span class="pln"> parser</span><span class="pun">.</span><span class="pln">getValue</span><span class="pun">(</span><span class="str">"password"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"pass"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"p"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> key </span><span class="pun">=</span><span class="pln"> parser</span><span class="pun">.</span><span class="pln">getValue</span><span class="pun">(</span><span class="str">"key"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">boolean</span><span class="pln"> help </span><span class="pun">=</span><span class="pln"> parser</span><span class="pun">.</span><span class="pln">containsKey</span><span class="pun">(</span><span class="str">"help"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"h"</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">help </span><span class="pun">||</span><span class="pln"> username </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> password </span><span class="pun">==</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="pln">err</span><span class="pun">.</span><span class="kwd">print</span><span class="pun">(</span><span class="str">"Usage: java BatchCellUpdater --username [user] --password [pass] --key [spreadsheet-key]\n\n"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">exit</span><span class="pun">(</span><span class="lit">1</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">long</span><span class="pln"> startTime </span><span class="pun">=</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="pln">currentTimeMillis</span><span class="pun">();</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Prepare Spreadsheet Service</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> ssSvc </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetService</span><span class="pun">(</span><span class="str">"Batch Cell Demo"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; ssSvc</span><span class="pun">.</span><span class="pln">setUserCredentials</span><span class="pun">(</span><span class="pln">username</span><span class="pun">,</span><span class="pln"> password</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">FeedURLFactory</span><span class="pln"> urlFactory </span><span class="pun">=</span><span class="pln"> </span><span class="typ">FeedURLFactory</span><span class="pun">.</span><span class="pln">getDefault</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; URL cellFeedUrl </span><span class="pun">=</span><span class="pln"> urlFactory</span><span class="pun">.</span><span class="pln">getCellFeedUrl</span><span class="pun">(</span><span class="pln">key</span><span class="pun">,</span><span class="pln"> </span><span class="str">"od6"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"private"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"full"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> cellFeed </span><span class="pun">=</span><span class="pln"> ssSvc</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">cellFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Build list of cell addresses to be filled in</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">CellAddress</span><span class="pun">&gt;</span><span class="pln"> cellAddrs </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">ArrayList</span><span class="pun">&lt;</span><span class="typ">CellAddress</span><span class="pun">&gt;();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> row </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> row </span><span class="pun">&lt;=</span><span class="pln"> MAX_ROWS</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">row</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">int</span><span class="pln"> col </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> col </span><span class="pun">&lt;=</span><span class="pln"> MAX_COLS</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">col</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; cellAddrs</span><span class="pun">.</span><span class="pln">add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellAddress</span><span class="pun">(</span><span class="pln">row</span><span class="pun">,</span><span class="pln"> col</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Prepare the update</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// getCellEntryMap is what makes the update fast.</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">&gt;</span><span class="pln"> cellEntries </span><span class="pun">=</span><span class="pln"> getCellEntryMap</span><span class="pun">(</span><span class="pln">ssSvc</span><span class="pun">,</span><span class="pln"> cellFeedUrl</span><span class="pun">,</span><span class="pln"> cellAddrs</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> batchRequest </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellAddress</span><span class="pln"> cellAddr </span><span class="pun">:</span><span class="pln"> cellAddrs</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; URL entryUrl </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln">cellFeedUrl</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">()</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="str">"/"</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> cellAddr</span><span class="pun">.</span><span class="pln">idString</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellEntry</span><span class="pln"> batchEntry </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">(</span><span class="pln">cellEntries</span><span class="pun">.</span><span class="kwd">get</span><span class="pun">(</span><span class="pln">cellAddr</span><span class="pun">.</span><span class="pln">idString</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; batchEntry</span><span class="pun">.</span><span class="pln">changeInputValueLocal</span><span class="pun">(</span><span class="pln">cellAddr</span><span class="pun">.</span><span class="pln">idString</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">BatchUtils</span><span class="pun">.</span><span class="pln">setBatchId</span><span class="pun">(</span><span class="pln">batchEntry</span><span class="pun">,</span><span class="pln"> cellAddr</span><span class="pun">.</span><span class="pln">idString</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">BatchUtils</span><span class="pun">.</span><span class="pln">setBatchOperationType</span><span class="pun">(</span><span class="pln">batchEntry</span><span class="pun">,</span><span class="pln"> </span><span class="typ">BatchOperationType</span><span class="pun">.</span><span class="pln">UPDATE</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; batchRequest</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">().</span><span class="pln">add</span><span class="pun">(</span><span class="pln">batchEntry</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Submit the update</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">Link</span><span class="pln"> batchLink </span><span class="pun">=</span><span class="pln"> cellFeed</span><span class="pun">.</span><span class="pln">getLink</span><span class="pun">(</span><span class="typ">Link</span><span class="pun">.</span><span class="typ">Rel</span><span class="pun">.</span><span class="pln">FEED_BATCH</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Link</span><span class="pun">.</span><span class="typ">Type</span><span class="pun">.</span><span class="pln">ATOM</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> batchResponse </span><span class="pun">=</span><span class="pln"> ssSvc</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln">batchLink</span><span class="pun">.</span><span class="pln">getHref</span><span class="pun">()),</span><span class="pln"> batchRequest</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// Check the results</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">boolean</span><span class="pln"> isSuccess </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> entry </span><span class="pun">:</span><span class="pln"> batchResponse</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">String</span><span class="pln"> batchId </span><span class="pun">=</span><span class="pln"> </span><span class="typ">BatchUtils</span><span class="pun">.</span><span class="pln">getBatchId</span><span class="pun">(</span><span class="pln">entry</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="typ">BatchUtils</span><span class="pun">.</span><span class="pln">isSuccess</span><span class="pun">(</span><span class="pln">entry</span><span class="pun">))</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; isSuccess </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">BatchStatus</span><span class="pln"> status </span><span class="pun">=</span><span class="pln"> </span><span class="typ">BatchUtils</span><span class="pun">.</span><span class="pln">getBatchStatus</span><span class="pun">(</span><span class="pln">entry</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"%s failed (%s) %s"</span><span class="pun">,</span><span class="pln"> batchId</span><span class="pun">,</span><span class="pln"> status</span><span class="pun">.</span><span class="pln">getReason</span><span class="pun">(),</span><span class="pln"> status</span><span class="pun">.</span><span class="pln">getContent</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">println</span><span class="pun">(</span><span class="pln">isSuccess </span><span class="pun">?</span><span class="pln"> </span><span class="str">"\nBatch operations successful."</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"\nBatch operations failed"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"\n%s ms elapsed\n"</span><span class="pun">,</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="pln">currentTimeMillis</span><span class="pun">()</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> startTime</span><span class="pun">);</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; </span><span class="com">/**<br>&nbsp; &nbsp;* Connects to the specified {@link SpreadsheetService} and uses a batch<br>&nbsp; &nbsp;* request to retrieve a {@link CellEntry} for each cell enumerated in {@code<br>&nbsp; &nbsp;* cellAddrs}. Each cell entry is placed into a map keyed by its RnCn<br>&nbsp; &nbsp;* identifier.<br>&nbsp; &nbsp;*<br>&nbsp; &nbsp;* @param ssSvc the spreadsheet service to use.<br>&nbsp; &nbsp;* @param cellFeedUrl url of the cell feed.<br>&nbsp; &nbsp;* @param cellAddrs list of cell addresses to be retrieved.<br>&nbsp; &nbsp;* @return a map consisting of one {@link CellEntry} for each address in {@code<br>&nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; cellAddrs}<br>&nbsp; &nbsp;*/</span><span class="pln"><br>&nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">&gt;</span><span class="pln"> getCellEntryMap</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetService</span><span class="pln"> ssSvc</span><span class="pun">,</span><span class="pln"> URL cellFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">CellAddress</span><span class="pun">&gt;</span><span class="pln"> cellAddrs</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">throws</span><span class="pln"> </span><span class="typ">IOException</span><span class="pun">,</span><span class="pln"> </span><span class="typ">ServiceException</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> batchRequest </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pun">();</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellAddress</span><span class="pln"> cellId </span><span class="pun">:</span><span class="pln"> cellAddrs</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellEntry</span><span class="pln"> batchEntry </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">(</span><span class="pln">cellId</span><span class="pun">.</span><span class="pln">row</span><span class="pun">,</span><span class="pln"> cellId</span><span class="pun">.</span><span class="pln">col</span><span class="pun">,</span><span class="pln"> cellId</span><span class="pun">.</span><span class="pln">idString</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; batchEntry</span><span class="pun">.</span><span class="pln">setId</span><span class="pun">(</span><span class="typ">String</span><span class="pun">.</span><span class="pln">format</span><span class="pun">(</span><span class="str">"%s/%s"</span><span class="pun">,</span><span class="pln"> cellFeedUrl</span><span class="pun">.</span><span class="pln">toString</span><span class="pun">(),</span><span class="pln"> cellId</span><span class="pun">.</span><span class="pln">idString</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">BatchUtils</span><span class="pun">.</span><span class="pln">setBatchId</span><span class="pun">(</span><span class="pln">batchEntry</span><span class="pun">,</span><span class="pln"> cellId</span><span class="pun">.</span><span class="pln">idString</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">BatchUtils</span><span class="pun">.</span><span class="pln">setBatchOperationType</span><span class="pun">(</span><span class="pln">batchEntry</span><span class="pun">,</span><span class="pln"> </span><span class="typ">BatchOperationType</span><span class="pun">.</span><span class="pln">QUERY</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; batchRequest</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">().</span><span class="pln">add</span><span class="pun">(</span><span class="pln">batchEntry</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> cellFeed </span><span class="pun">=</span><span class="pln"> ssSvc</span><span class="pun">.</span><span class="pln">getFeed</span><span class="pun">(</span><span class="pln">cellFeedUrl</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> queryBatchResponse </span><span class="pun">=</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; ssSvc</span><span class="pun">.</span><span class="pln">batch</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> URL</span><span class="pun">(</span><span class="pln">cellFeed</span><span class="pun">.</span><span class="pln">getLink</span><span class="pun">(</span><span class="typ">Link</span><span class="pun">.</span><span class="typ">Rel</span><span class="pun">.</span><span class="pln">FEED_BATCH</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Link</span><span class="pun">.</span><span class="typ">Type</span><span class="pun">.</span><span class="pln">ATOM</span><span class="pun">).</span><span class="pln">getHref</span><span class="pun">()),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; batchRequest</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="typ">Map</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">&gt;</span><span class="pln"> cellEntryMap </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HashMap</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">&gt;(</span><span class="pln">cellAddrs</span><span class="pun">.</span><span class="pln">size</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> entry </span><span class="pun">:</span><span class="pln"> queryBatchResponse</span><span class="pun">.</span><span class="pln">getEntries</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; cellEntryMap</span><span class="pun">.</span><span class="pln">put</span><span class="pun">(</span><span class="typ">BatchUtils</span><span class="pun">.</span><span class="pln">getBatchId</span><span class="pun">(</span><span class="pln">entry</span><span class="pun">),</span><span class="pln"> entry</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">System</span><span class="pun">.</span><span class="kwd">out</span><span class="pun">.</span><span class="pln">printf</span><span class="pun">(</span><span class="str">"batch %s {CellEntry: id=%s editLink=%s inputValue=%s\n"</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">BatchUtils</span><span class="pun">.</span><span class="pln">getBatchId</span><span class="pun">(</span><span class="pln">entry</span><span class="pun">),</span><span class="pln"> entry</span><span class="pun">.</span><span class="pln">getId</span><span class="pun">(),</span><span class="pln"> entry</span><span class="pun">.</span><span class="pln">getEditLink</span><span class="pun">().</span><span class="pln">getHref</span><span class="pun">(),</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entry</span><span class="pun">.</span><span class="pln">getCell</span><span class="pun">().</span><span class="pln">getInputValue</span><span class="pun">());</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> cellEntryMap</span><span class="pun">;</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section><section><h3 style="display: none; ">.NET</h3><p>The following is a complete program for updating large numbers of cells.
    It uses ClientLogin for authentication and authorization.</p><pre class="prettyprint"><code><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">System</span><span class="pun">.</span><span class="typ">Collections</span><span class="pun">.</span><span class="typ">Generic</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Client</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">using</span><span class="pln"> </span><span class="typ">Google</span><span class="pun">.</span><span class="typ">GData</span><span class="pun">.</span><span class="typ">Spreadsheets</span><span class="pun">;</span><span class="pln"><br><br></span><span class="com">/**<br>&nbsp;* A sample application showing how to efficiently use batch updates with the<br>&nbsp;* Spreadsheets API to create new cells.<br>&nbsp;*<br>&nbsp;* The specified spreadsheet key will be filled in with 'RnCn' identifier of<br>&nbsp;* each cell, up to the {@code MAX_ROWS} and {@code MAX_COLS} constants defined<br>&nbsp;* in this class.<br>&nbsp;*<br>&nbsp;* Usage: BatchCellUpdater [user] [pass] [spreadsheet-key]<br>&nbsp;*<br>&nbsp;* @author Claudio Cherubino<br>&nbsp;*/</span><span class="pln"><br></span><span class="kwd">namespace</span><span class="pln"> </span><span class="typ">MySpreadsheetIntegration</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">BatchCellUpdater</span><span class="pln"><br>&nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="com">// The number of rows to fill in the destination workbook</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAX_ROWS </span><span class="pun">=</span><span class="pln"> </span><span class="lit">75</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">// The number of columns to fill in the destination workbook</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> MAX_COLS </span><span class="pun">=</span><span class="pln"> </span><span class="lit">5</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">/**<br>&nbsp; &nbsp; &nbsp;* A basic struct to store cell row/column information and the associated RnCn<br>&nbsp; &nbsp; &nbsp;* identifier.<br>&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">CellAddress</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Row</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> </span><span class="typ">Col</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="kwd">string</span><span class="pln"> </span><span class="typ">IdString</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">/**<br>&nbsp; &nbsp; &nbsp; &nbsp;* Constructs a CellAddress representing the specified {@code row} and<br>&nbsp; &nbsp; &nbsp; &nbsp;* {@code col}. The IdString will be set in 'RnCn' notation.<br>&nbsp; &nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">CellAddress</span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> row</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">uint</span><span class="pln"> col</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="typ">Row</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> row</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="typ">Col</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> col</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">this</span><span class="pun">.</span><span class="typ">IdString</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">string</span><span class="pun">.</span><span class="typ">Format</span><span class="pun">(</span><span class="str">"R{0}C{1}"</span><span class="pun">,</span><span class="pln"> row</span><span class="pun">,</span><span class="pln"> col</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">static</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> </span><span class="typ">Main</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">[]</span><span class="pln"> args</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> username</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> password</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> key</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Command line parsing</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">args</span><span class="pun">.</span><span class="typ">Length</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">3</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">Error</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"Syntax: BatchCellUpdater &lt;username&gt; &lt;password&gt; &lt;key&gt;"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; username </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; password </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">1</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; key </span><span class="pun">=</span><span class="pln"> args</span><span class="pun">[</span><span class="lit">2</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Prepare Spreadsheet Service</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">SpreadsheetsService</span><span class="pun">(</span><span class="str">"MySpreadsheetIntegration-v1"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; service</span><span class="pun">.</span><span class="pln">setUserCredentials</span><span class="pun">(</span><span class="pln">username</span><span class="pun">,</span><span class="pln"> password</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellQuery</span><span class="pln"> cellQuery </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellQuery</span><span class="pun">(</span><span class="pln">key</span><span class="pun">,</span><span class="pln"> </span><span class="str">"od6"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"private"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"full"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> cellFeed </span><span class="pun">=</span><span class="pln"> service</span><span class="pun">.</span><span class="typ">Query</span><span class="pun">(</span><span class="pln">cellQuery</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Build list of cell addresses to be filled in</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">CellAddress</span><span class="pun">&gt;</span><span class="pln"> cellAddrs </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">CellAddress</span><span class="pun">&gt;();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> row </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> row </span><span class="pun">&lt;=</span><span class="pln"> MAX_ROWS</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">row</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">uint</span><span class="pln"> col </span><span class="pun">=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"> col </span><span class="pun">&lt;=</span><span class="pln"> MAX_COLS</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">col</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cellAddrs</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellAddress</span><span class="pun">(</span><span class="pln">row</span><span class="pun">,</span><span class="pln"> col</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Prepare the update</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// GetCellEntryMap is what makes the update fast.</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Dictionary</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">&gt;</span><span class="pln"> cellEntries </span><span class="pun">=</span><span class="pln"> </span><span class="typ">GetCellEntryMap</span><span class="pun">(</span><span class="pln">service</span><span class="pun">,</span><span class="pln"> cellFeed</span><span class="pun">,</span><span class="pln"> cellAddrs</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> batchRequest </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pun">(</span><span class="pln">cellQuery</span><span class="pun">.</span><span class="typ">Uri</span><span class="pun">,</span><span class="pln"> service</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellAddress</span><span class="pln"> cellAddr </span><span class="kwd">in</span><span class="pln"> cellAddrs</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CellEntry</span><span class="pln"> batchEntry </span><span class="pun">=</span><span class="pln"> cellEntries</span><span class="pun">[</span><span class="pln">cellAddr</span><span class="pun">.</span><span class="typ">IdString</span><span class="pun">];</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; batchEntry</span><span class="pun">.</span><span class="typ">InputValue</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> cellAddr</span><span class="pun">.</span><span class="typ">IdString</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; batchEntry</span><span class="pun">.</span><span class="typ">BatchData</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GDataBatchEntryData</span><span class="pun">(</span><span class="pln">cellAddr</span><span class="pun">.</span><span class="typ">IdString</span><span class="pun">,</span><span class="pln"> </span><span class="typ">GDataBatchOperationType</span><span class="pun">.</span><span class="pln">update</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; batchRequest</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="pln">batchEntry</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Submit the update</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> batchResponse </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellFeed</span><span class="pun">)</span><span class="pln">service</span><span class="pun">.</span><span class="typ">Batch</span><span class="pun">(</span><span class="pln">batchRequest</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Uri</span><span class="pun">(</span><span class="pln">cellFeed</span><span class="pun">.</span><span class="typ">Batch</span><span class="pun">));</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="com">// Check the results</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">bool</span><span class="pln"> isSuccess </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> entry </span><span class="kwd">in</span><span class="pln"> batchResponse</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">string</span><span class="pln"> batchId </span><span class="pun">=</span><span class="pln"> entry</span><span class="pun">.</span><span class="typ">BatchData</span><span class="pun">.</span><span class="typ">Id</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">entry</span><span class="pun">.</span><span class="typ">BatchData</span><span class="pun">.</span><span class="typ">Status</span><span class="pun">.</span><span class="typ">Code</span><span class="pln"> </span><span class="pun">!=</span><span class="pln"> </span><span class="lit">200</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; isSuccess </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">GDataBatchStatus</span><span class="pln"> status </span><span class="pun">=</span><span class="pln"> entry</span><span class="pun">.</span><span class="typ">BatchData</span><span class="pun">.</span><span class="typ">Status</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"{0} failed ({1})"</span><span class="pun">,</span><span class="pln"> batchId</span><span class="pun">,</span><span class="pln"> status</span><span class="pun">.</span><span class="typ">Reason</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="pln">isSuccess </span><span class="pun">?</span><span class="pln"> </span><span class="str">"Batch operations successful."</span><span class="pln"> </span><span class="pun">:</span><span class="pln"> </span><span class="str">"Batch operations failed"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="com">/**<br>&nbsp; &nbsp; &nbsp;* Connects to the specified {@link SpreadsheetsService} and uses a batch<br>&nbsp; &nbsp; &nbsp;* request to retrieve a {@link CellEntry} for each cell enumerated in {@code<br>&nbsp; &nbsp; &nbsp;* cellAddrs}. Each cell entry is placed into a map keyed by its RnCn<br>&nbsp; &nbsp; &nbsp;* identifier.<br>&nbsp; &nbsp; &nbsp;*<br>&nbsp; &nbsp; &nbsp;* @param service the spreadsheet service to use.<br>&nbsp; &nbsp; &nbsp;* @param cellFeed the cell feed to use.<br>&nbsp; &nbsp; &nbsp;* @param cellAddrs list of cell addresses to be retrieved.<br>&nbsp; &nbsp; &nbsp;* @return a dictionary consisting of one {@link CellEntry} for each address in {@code<br>&nbsp; &nbsp; &nbsp;* &nbsp; &nbsp; &nbsp; &nbsp; cellAddrs}<br>&nbsp; &nbsp; &nbsp;*/</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">static</span><span class="pln"> </span><span class="typ">Dictionary</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">&gt;</span><span class="pln"> </span><span class="typ">GetCellEntryMap</span><span class="pun">(</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">SpreadsheetsService</span><span class="pln"> service</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pln"> cellFeed</span><span class="pun">,</span><span class="pln"> </span><span class="typ">List</span><span class="pun">&lt;</span><span class="typ">CellAddress</span><span class="pun">&gt;</span><span class="pln"> cellAddrs</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> batchRequest </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellFeed</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Uri</span><span class="pun">(</span><span class="pln">cellFeed</span><span class="pun">.</span><span class="typ">Self</span><span class="pun">),</span><span class="pln"> service</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellAddress</span><span class="pln"> cellId </span><span class="kwd">in</span><span class="pln"> cellAddrs</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">CellEntry</span><span class="pln"> batchEntry </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">(</span><span class="pln">cellId</span><span class="pun">.</span><span class="typ">Row</span><span class="pun">,</span><span class="pln"> cellId</span><span class="pun">.</span><span class="typ">Col</span><span class="pun">,</span><span class="pln"> cellId</span><span class="pun">.</span><span class="typ">IdString</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; batchEntry</span><span class="pun">.</span><span class="typ">Id</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">AtomId</span><span class="pun">(</span><span class="kwd">string</span><span class="pun">.</span><span class="typ">Format</span><span class="pun">(</span><span class="str">"{0}/{1}"</span><span class="pun">,</span><span class="pln"> cellFeed</span><span class="pun">.</span><span class="typ">Self</span><span class="pun">,</span><span class="pln"> cellId</span><span class="pun">.</span><span class="typ">IdString</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; batchEntry</span><span class="pun">.</span><span class="typ">BatchData</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">GDataBatchEntryData</span><span class="pun">(</span><span class="pln">cellId</span><span class="pun">.</span><span class="typ">IdString</span><span class="pun">,</span><span class="pln"> </span><span class="typ">GDataBatchOperationType</span><span class="pun">.</span><span class="pln">query</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; batchRequest</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="pln">batchEntry</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">CellFeed</span><span class="pln"> queryBatchResponse </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellFeed</span><span class="pun">)</span><span class="pln">service</span><span class="pun">.</span><span class="typ">Batch</span><span class="pun">(</span><span class="pln">batchRequest</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Uri</span><span class="pun">(</span><span class="pln">cellFeed</span><span class="pun">.</span><span class="typ">Batch</span><span class="pun">));</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="typ">Dictionary</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">&gt;</span><span class="pln"> cellEntryMap </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Dictionary</span><span class="pun">&lt;</span><span class="typ">String</span><span class="pun">,</span><span class="pln"> </span><span class="typ">CellEntry</span><span class="pun">&gt;();</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">foreach</span><span class="pln"> </span><span class="pun">(</span><span class="typ">CellEntry</span><span class="pln"> entry </span><span class="kwd">in</span><span class="pln"> queryBatchResponse</span><span class="pun">.</span><span class="typ">Entries</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; cellEntryMap</span><span class="pun">.</span><span class="typ">Add</span><span class="pun">(</span><span class="pln">entry</span><span class="pun">.</span><span class="typ">BatchData</span><span class="pun">.</span><span class="typ">Id</span><span class="pun">,</span><span class="pln"> entry</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="typ">Console</span><span class="pun">.</span><span class="typ">WriteLine</span><span class="pun">(</span><span class="str">"batch {0} (CellEntry: id={1} editLink={2} inputValue={3})"</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entry</span><span class="pun">.</span><span class="typ">BatchData</span><span class="pun">.</span><span class="typ">Id</span><span class="pun">,</span><span class="pln"> entry</span><span class="pun">.</span><span class="typ">Id</span><span class="pun">,</span><span class="pln"> entry</span><span class="pun">.</span><span class="typ">EditUri</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; entry</span><span class="pun">.</span><span class="typ">InputValue</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pln"> cellEntryMap</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span></code></pre></section></div>


        </div>
        
<div id="gc-content-footer">



<div id="gc-content-last-updated">Last updated julio 18, 2012.</div>

</div>

      </div>

      </div>
      

      
      <footer id="gc-footer">
        <div id="gc-copyright">
          <a href="https://developers.google.com/?hl=es">
            <img id="developers-logo-footer" src="./Google Apps Platform — Google Developers_files/developers-logo-footer.png" alt="Google Developers logo" style="vertical-align: center; float: left">
          </a>
          <ul>
            <li><a href="http://www.google.com/">Google</a></li>
            <li><a href="https://developers.google.com/readme/terms?hl=es">Condiciones de servicio</a></li>
            <li><a href="http://www.google.com/intl/en/privacy/">Política de privacidad</a></li>
            <li><a href="https://developers.google.com/jobs?hl=es">Empleo</a></li>
            <li><a class="google-feedback" data-p="81425" data-b="Documentation" data-v="prod44c.360733855122011525" href="./Google Apps Platform — Google Developers_files/Google Apps Platform — Google Developers.html">Report a bug</a></li>
          </ul>
        </div>
        
        <div id="gc-language">
          <ul>
            <li>
              <form id="setlang" action="https://developers.google.com/i18n/setlang/" method="post">
                <div style="display:none"><input type="hidden" name="csrfmiddlewaretoken" value="330cd2762e4c7034596236c432214f63"></div>
                <select id="footer_language" name="language" style="display: none; ">
                  
                  
                  <option value="ar">
                    العربيّة
                  </option>
                  
                  <option value="bg">
                    български
                  </option>
                  
                  <option value="ca">
                    català
                  </option>
                  
                  <option value="zh-cn">
                    简体中文
                  </option>
                  
                  <option value="zh-tw">
                    繁體中文
                  </option>
                  
                  <option value="hr">
                    Hrvatski
                  </option>
                  
                  <option value="cs">
                    česky
                  </option>
                  
                  <option value="da">
                    Dansk
                  </option>
                  
                  <option value="nl">
                    Nederlands
                  </option>
                  
                  <option value="en">
                    English
                  </option>
                  
                  <option value="fa">
                    فارسی
                  </option>
                  
                  <option value="fi">
                    suomi
                  </option>
                  
                  <option value="fr">
                    Français
                  </option>
                  
                  <option value="de">
                    Deutsch
                  </option>
                  
                  <option value="el">
                    Ελληνικά
                  </option>
                  
                  <option value="he">
                    עברית
                  </option>
                  
                  <option value="hi">
                    Hindi
                  </option>
                  
                  <option value="hu">
                    Magyar
                  </option>
                  
                  <option value="id">
                    Bahasa Indonesia
                  </option>
                  
                  <option value="it">
                    italiano
                  </option>
                  
                  <option value="ja">
                    日本語
                  </option>
                  
                  <option value="ko">
                    한국어
                  </option>
                  
                  <option value="lv">
                    latviešu
                  </option>
                  
                  <option value="lt">
                    Lithuanian
                  </option>
                  
                  <option value="nb">
                    Norsk (bokmål)
                  </option>
                  
                  <option value="nn">
                    Norsk (nynorsk)
                  </option>
                  
                  <option value="pl">
                    polski
                  </option>
                  
                  <option value="pt-br">
                    Português Brasileiro
                  </option>
                  
                  <option value="pt">
                    Português
                  </option>
                  
                  <option value="ro">
                    Română
                  </option>
                  
                  <option value="ru">
                    Русский
                  </option>
                  
                  <option value="sr">
                    српски
                  </option>
                  
                  <option value="sk">
                    slovenský
                  </option>
                  
                  <option value="sl">
                    Slovenščina
                  </option>
                  
                  <option value="es" selected="selected">
                    español
                  </option>
                  
                  <option value="sv">
                    Svenska
                  </option>
                  
                  <option value="th">
                    Thai
                  </option>
                  
                  <option value="tr">
                    Türkçe
                  </option>
                  
                  <option value="uk">
                    Українська
                  </option>
                  
                  <option value="vi">
                    Vietnamese
                  </option>
                  
                </select><span class="kd-button kd-menubutton kd-select"><div style="display: inline-block; "><div class="label" style="float: left; ">
                    español
                  </div><div class="kd-disclosureindicator"></div></div></span>
              </form>
            </li>
          </ul>
        </div>
        
      </footer>
      
    </div>
    <div id="needAuth" class="msgDialogContent">
      
      <h1>Authentication required</h1>
      
      <div>
        You need to be signed in with <a href="http://www.google.com/+">Google+</a> to do that.
      </div>
      <button>Sign in</button>
      <button>Cancelar</button>
    </div>
    <div id="signingIn" class="msgDialogContent">
      
      <h1>Signing you in...</h1>
      <div>
        
        Google Developers needs your permission to do that.
      </div>
      
      <button>Volver a intentarlo</button>
      
      <button>Cancelar</button>
    </div>
    <script src="./Google Apps Platform — Google Developers_files/script_foot.js"></script>
    <script>
      (function($) {
        devsite.devsite.Init($);
      })(jQuery);

      
      devsite.localInit = function() {
        
      };
      
    </script>
    <!-- Google Code for PXL - Developers - Codesite - HP - 90d Remarketing List -->
    <script type="text/javascript">
    $('#setlang select').each(function() {
      if ($.browser.msie) {
        $(this).change(function() {
          $('#setlang').submit();
        });
      } else {
        $(this).kdSelect({'change': function() {
          $('#setlang').submit();
        }});
      }
    });
    </script><ul style="position: absolute; left: 1367px; top: 64034px; display: none; " class="kd-menulist"><li class="kd-menulistitem" style="">
                    العربيّة
                  </li><li class="kd-menulistitem">
                    български
                  </li><li class="kd-menulistitem">
                    català
                  </li><li class="kd-menulistitem">
                    简体中文
                  </li><li class="kd-menulistitem">
                    繁體中文
                  </li><li class="kd-menulistitem">
                    Hrvatski
                  </li><li class="kd-menulistitem">
                    česky
                  </li><li class="kd-menulistitem">
                    Dansk
                  </li><li class="kd-menulistitem">
                    Nederlands
                  </li><li class="kd-menulistitem">
                    English
                  </li><li class="kd-menulistitem">
                    فارسی
                  </li><li class="kd-menulistitem">
                    suomi
                  </li><li class="kd-menulistitem">
                    Français
                  </li><li class="kd-menulistitem">
                    Deutsch
                  </li><li class="kd-menulistitem">
                    Ελληνικά
                  </li><li class="kd-menulistitem">
                    עברית
                  </li><li class="kd-menulistitem">
                    Hindi
                  </li><li class="kd-menulistitem">
                    Magyar
                  </li><li class="kd-menulistitem">
                    Bahasa Indonesia
                  </li><li class="kd-menulistitem">
                    italiano
                  </li><li class="kd-menulistitem">
                    日本語
                  </li><li class="kd-menulistitem">
                    한국어
                  </li><li class="kd-menulistitem">
                    latviešu
                  </li><li class="kd-menulistitem">
                    Lithuanian
                  </li><li class="kd-menulistitem">
                    Norsk (bokmål)
                  </li><li class="kd-menulistitem">
                    Norsk (nynorsk)
                  </li><li class="kd-menulistitem">
                    polski
                  </li><li class="kd-menulistitem">
                    Português Brasileiro
                  </li><li class="kd-menulistitem">
                    Português
                  </li><li class="kd-menulistitem">
                    Română
                  </li><li class="kd-menulistitem">
                    Русский
                  </li><li class="kd-menulistitem">
                    српски
                  </li><li class="kd-menulistitem">
                    slovenský
                  </li><li class="kd-menulistitem">
                    Slovenščina
                  </li><li class="kd-menulistitem selected">
                    español
                  </li><li class="kd-menulistitem">
                    Svenska
                  </li><li class="kd-menulistitem">
                    Thai
                  </li><li class="kd-menulistitem">
                    Türkçe
                  </li><li class="kd-menulistitem">
                    Українська
                  </li><li class="kd-menulistitem">
                    Vietnamese
                  </li></ul>
    <script type="text/javascript">
      /* <![CDATA[ */
      var google_conversion_id = 992540712;
      var google_conversion_language = "en";
      var google_conversion_format = "3";
      var google_conversion_color = "ffffff";
      var google_conversion_label = "qio2CKCPwQMQqPCj2QM";
      var google_conversion_value = 0;
      /* ]]> */
    </script>
    <script type="text/javascript" src="./Google Apps Platform — Google Developers_files/conversion.js">
    </script><img height="1" width="1" border="0" src="./Google Apps Platform — Google Developers_files/saved_resource(2)">
    <noscript>
      &lt;div style="display:inline;"&gt;
        &lt;img height="1" width="1" style="border-style:none;" alt="" src="//www.googleadservices.com/pagead/conversion/992540712/?label=qio2CKCPwQMQqPCj2QM&amp;amp;guid=ON&amp;amp;script=0"/&gt;
      &lt;/div&gt;
    </noscript>
    



<script type="text/javascript">
$(document).ready(function(e) {
    // Render any carousels on the page
    $('.carousel').carousel();
    // Render any feed widgets on the page
    
    $('.feed').rss();
    // Render any OSS widgets on the page.
    $('.oss').oss();
    });
</script>

<script type="text/javascript" defer="">
// Add the handlers once the document has loaded.
$(document).ready(function() {
    contentTimer.name = 'content';
    contentTimer.tick('ol');
    window.jstiming.report(contentTimer);

    // Boilerplate javascript to enable the plusone button
    var po = document.createElement('script'); po.type = 'text/javascript';
    po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js?onload=devsite_plusoneLoaded';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(po, s);
});
</script>




  

</body></html>